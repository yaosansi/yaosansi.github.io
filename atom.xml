<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>yaosansi&#39;s blog</title>
  
  <subtitle>技术改变世界，产品改变生活</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.yaosansi.com/"/>
  <updated>2017-12-30T16:16:59.972Z</updated>
  <id>http://www.yaosansi.com/</id>
  
  <author>
    <name>yaosansi</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CentOS7上YUM安装MariaDB 10</title>
    <link href="http://www.yaosansi.com/post/install-mariadb-yum-on-centos/"/>
    <id>http://www.yaosansi.com/post/install-mariadb-yum-on-centos/</id>
    <published>2017-05-31T10:51:17.000Z</published>
    <updated>2017-12-30T16:16:59.972Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CentOS7上YUM安装MariaDB-10"><a href="#CentOS7上YUM安装MariaDB-10" class="headerlink" title="CentOS7上YUM安装MariaDB 10"></a>CentOS7上YUM安装MariaDB 10</h3><p>首先先要去mariadb网站获取下载信息，以便下一步编辑安装的配置文件：</p><p>找到你要装的版本 - 比如当前选择的是CentOS/64位/10.2<br><a href="https://downloads.mariadb.org/mariadb/repositories/#mirror=tuna&amp;distro=CentOS&amp;distro_release=centos7-amd64--centos7&amp;version=10.2" target="_blank" rel="noopener">https://downloads.mariadb.org/mariadb/repositories/#mirror=tuna&amp;distro=CentOS&amp;distro_release=centos7-amd64--centos7&amp;version=10.2</a></p><h4 id="配置YUM安装源"><a href="#配置YUM安装源" class="headerlink" title="配置YUM安装源"></a>配置YUM安装源</h4><p>下面是 CentOS的自定义安装YUM源，粘贴复制这些到<code>/etc/yum.repos.d/</code>,建议命名<br><code>MariaDB.repo</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># MariaDB 10.2 CentOS repository list - created 2017-12-26 14:20 UTC</span><br><span class="line"># http://downloads.mariadb.org/mariadb/repositories/</span><br><span class="line">[mariadb]</span><br><span class="line">name = MariaDB</span><br><span class="line">baseurl = http://yum.mariadb.org/10.2/centos7-amd64</span><br><span class="line">gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB</span><br><span class="line">gpgcheck=1</span><br></pre></td></tr></table></figure><p>因为官网的源下载安装非常慢，可以用以下源：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># MariaDB 10.2 CentOS repository list - created 2017-07-03 06:59 UTC</span><br><span class="line"># http://downloads.mariadb.org/mariadb/repositories/</span><br><span class="line">[mariadb] </span><br><span class="line">name = MariaDB</span><br><span class="line">baseurl = https://mirrors.ustc.edu.cn/mariadb/yum/10.2/centos7-amd64</span><br><span class="line">gpgkey=https://mirrors.ustc.edu.cn/mariadb/yum/RPM-GPG-KEY-MariaDB</span><br><span class="line">gpgcheck=1</span><br></pre></td></tr></table></figure><h4 id="安装MariaDB"><a href="#安装MariaDB" class="headerlink" title="安装MariaDB"></a>安装MariaDB</h4><p>更新完上述文件以后，使用以下命令安装 MariaDB:</p><blockquote><p>sudo yum install MariaDB-server MariaDB-client</p></blockquote><p>安装完成其它步骤参考 <a href="http://www.yaosansi.com/post/install-mysql-yum-on-centos/">CentOS7上YUM安装MySQL5.7</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;CentOS7上YUM安装MariaDB-10&quot;&gt;&lt;a href=&quot;#CentOS7上YUM安装MariaDB-10&quot; class=&quot;headerlink&quot; title=&quot;CentOS7上YUM安装MariaDB 10&quot;&gt;&lt;/a&gt;CentOS7上YUM安装Mari
      
    
    </summary>
    
      <category term="centos" scheme="http://www.yaosansi.com/categories/centos/"/>
    
    
      <category term="centos" scheme="http://www.yaosansi.com/tags/centos/"/>
    
      <category term="yum" scheme="http://www.yaosansi.com/tags/yum/"/>
    
      <category term="mariadb" scheme="http://www.yaosansi.com/tags/mariadb/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7上YUM安装MySQL5.7</title>
    <link href="http://www.yaosansi.com/post/install-mysql-yum-on-centos/"/>
    <id>http://www.yaosansi.com/post/install-mysql-yum-on-centos/</id>
    <published>2017-05-29T07:14:42.000Z</published>
    <updated>2017-12-30T16:18:24.062Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CentOS7上YUM安装MySQL5-7"><a href="#CentOS7上YUM安装MySQL5-7" class="headerlink" title="CentOS7上YUM安装MySQL5.7"></a>CentOS7上YUM安装MySQL5.7</h3><h4 id="1、配置YUM源"><a href="#1、配置YUM源" class="headerlink" title="1、配置YUM源"></a>1、配置YUM源</h4><p>在MySQL官网中下载YUM源rpm安装包：<a href="http://dev.mysql.com/downloads/repo/yum/" target="_blank" rel="noopener">http://dev.mysql.com/downloads/repo/yum/</a> </p><p>找到以下源,并下载安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Red Hat Enterprise Linux 7 / Oracle Linux 7 (Architecture Independent), RPM Package25.1K</span><br><span class="line">Download</span><br><span class="line">(mysql57-community-release-el7-11.noarch.rpm)</span><br></pre></td></tr></table></figure></p><h5 id="下载MySQL源安装包"><a href="#下载MySQL源安装包" class="headerlink" title="下载MySQL源安装包"></a>下载MySQL源安装包</h5><blockquote><p>wget <a href="https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm" target="_blank" rel="noopener">https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm</a></p></blockquote><h5 id="安装MySQL源"><a href="#安装MySQL源" class="headerlink" title="安装MySQL源"></a>安装MySQL源</h5><blockquote><p>yum localinstall mysql57-community-release-el7-11.noarch.rpm</p></blockquote><h4 id="2、安装MySQL"><a href="#2、安装MySQL" class="headerlink" title="2、安装MySQL"></a>2、安装MySQL</h4><blockquote><p>yum install mysql-community-server</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">========================================================================================</span><br><span class="line"> Package                        Arch      Version            Repository            Size</span><br><span class="line">========================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> mysql-community-libs           x86_64    5.7.20-1.el7       mysql57-community    2.1 M</span><br><span class="line">     replacing  mariadb-libs.x86_64 1:5.5.56-2.el7</span><br><span class="line"> mysql-community-libs-compat    x86_64    5.7.20-1.el7       mysql57-community    2.0 M</span><br><span class="line">     replacing  mariadb-libs.x86_64 1:5.5.56-2.el7</span><br><span class="line"> mysql-community-server         x86_64    5.7.20-1.el7       mysql57-community    164 M</span><br><span class="line">Installing for dependencies:</span><br><span class="line"> libaio                         x86_64    0.3.109-13.el7     base                  24 k</span><br><span class="line"> mysql-community-client         x86_64    5.7.20-1.el7       mysql57-community     24 M</span><br><span class="line"> mysql-community-common         x86_64    5.7.20-1.el7       mysql57-community    272 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">========================================================================================</span><br><span class="line">Install  3 Packages (+3 Dependent packages)</span><br></pre></td></tr></table></figure><h4 id="3、启动MySQL服务"><a href="#3、启动MySQL服务" class="headerlink" title="3、启动MySQL服务"></a>3、启动MySQL服务</h4><blockquote><p>systemctl start mysqld</p></blockquote><p>查看MySQL的启动状态</p><blockquote><p>systemctl status mysqld</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">● mysqld.service - MySQL Server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Tue 2017-12-26 21:35:32 CST; 51s ago</span><br><span class="line">     Docs: man:mysqld(8)</span><br><span class="line">           http://dev.mysql.com/doc/refman/en/using-systemd.html</span><br><span class="line">  Process: 9907 ExecStart=/usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS (code=exited, status=0/SUCCESS)</span><br><span class="line">  Process: 9833 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 9910 (mysqld)</span><br><span class="line">   CGroup: /system.slice/mysqld.service</span><br><span class="line">           └─9910 /usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid</span><br><span class="line"></span><br><span class="line">Dec 26 21:35:26 ecs-mall systemd[1]: Starting MySQL Server...</span><br><span class="line">Dec 26 21:35:32 ecs-mall systemd[1]: Started MySQL Server.</span><br></pre></td></tr></table></figure><h4 id="4、开机启动"><a href="#4、开机启动" class="headerlink" title="4、开机启动"></a>4、开机启动</h4><blockquote><p>systemctl enable mysqld</p><p>systemctl daemon-reload</p></blockquote><h4 id="5、修改root本地登录密码"><a href="#5、修改root本地登录密码" class="headerlink" title="5、修改root本地登录密码"></a>5、修改root本地登录密码</h4><p>mysql安装完成之后，在<code>/var/log/mysqld.log</code>文件中给<code>root</code>生成了一个默认密码。通过下面的方式找到<code>root默认密码</code>，然后登录<code>mysql</code>进行修改：</p><p>找到密码：</p><blockquote><p><code>grep &#39;temporary password&#39; /var/log/mysqld.log</code></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep &apos;temporary password&apos; /var/log/mysqld.log</span><br><span class="line">2017-12-26T13:35:28.432260Z 1 [Note] A temporary password is generated for root@localhost: lLeNXPJaR3=D</span><br></pre></td></tr></table></figure><p>登录Mysql:</p><blockquote><p>mysql -uroot -p</p></blockquote><p>输入上面找到的随机密码后，修改密码：</p><blockquote><p><code>mysql&gt; ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;MyNewPass4!&#39;;</code></p></blockquote><p>或者</p><blockquote><p><code>mysql&gt; set password for &#39;root&#39;@&#39;localhost&#39;=password(&#39;MyNewPass4!&#39;);</code></p><p>注意：<code>mysql5.7</code>默认安装了密码安全检查插件（validate_password），默认密码检查策略要求密码必须包含：大小写字母、数字和特殊符号，并且长度不能少于8位。否则会提示<code>ERROR 1819 (HY000): Your password does not satisfy the current policy requirements</code>错误</p></blockquote><p>通过msyql环境变量可以查看密码策略的相关信息：</p><blockquote><p><code>mysql&gt; show variables like &#39;%password%&#39;;</code></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">+---------------------------------------+--------+</span><br><span class="line">| Variable_name                         | Value  |</span><br><span class="line">+---------------------------------------+--------+</span><br><span class="line">| default_password_lifetime             | 0      |</span><br><span class="line">| disconnect_on_expired_password        | ON     |</span><br><span class="line">| log_builtin_as_identified_by_password | OFF    |</span><br><span class="line">| mysql_native_password_proxy_users     | OFF    |</span><br><span class="line">| old_passwords                         | 0      |</span><br><span class="line">| report_password                       |        |</span><br><span class="line">| sha256_password_proxy_users           | OFF    |</span><br><span class="line">| validate_password_check_user_name     | OFF    |</span><br><span class="line">| validate_password_dictionary_file     |        |</span><br><span class="line">| validate_password_length              | 8      |</span><br><span class="line">| validate_password_mixed_case_count    | 1      |</span><br><span class="line">| validate_password_number_count        | 1      |</span><br><span class="line">| validate_password_policy              | MEDIUM |</span><br><span class="line">| validate_password_special_char_count  | 1      |</span><br><span class="line">+---------------------------------------+--------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">validate_password_policy：密码策略，默认为MEDIUM策略 </span><br><span class="line">validate_password_dictionary_file：密码策略文件，策略为STRONG才需要 </span><br><span class="line">validate_password_length：密码最少长度 </span><br><span class="line">validate_password_mixed_case_count：大小写字符长度，至少1个 </span><br><span class="line">validate_password_number_count ：数字至少1个 </span><br><span class="line">validate_password_special_char_count：特殊字符至少1个</span><br></pre></td></tr></table></figure><p>上述参数是默认策略MEDIUM的密码检查规则。</p><p>共有以下几种密码策略：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">策略检查规则</span><br><span class="line">0 or LOWLength</span><br><span class="line">1 or MEDIUMLength; numeric, lowercase/uppercase, and special characters</span><br><span class="line">2 or STRONGLength; numeric, lowercase/uppercase, and special characters; dictionary file</span><br></pre></td></tr></table></figure><p>MySQL官网密码策略详细说明：<a href="http://dev.mysql.com/doc/refman/5.7/en/validate-password-options-variables.html#sysvar_validate_password_policy" target="_blank" rel="noopener">http://dev.mysql.com/doc/refman/5.7/en/validate-password-options-variables.html#sysvar_validate_password_policy</a></p><p>修改密码策略</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在/etc/my.cnf文件添加validate_password_policy配置，指定密码策略</span><br><span class="line"># 选择0（LOW），1（MEDIUM），2（STRONG）其中一种，选择2需要提供密码字典文件</span><br><span class="line">validate_password_policy=0</span><br></pre></td></tr></table></figure><p>如果不需要密码策略，添加<code>my.cnf</code>文件中添加如下配置禁用即可：</p><blockquote><p>validate_password = off</p></blockquote><p>重新启动mysql服务使配置生效：</p><blockquote><p>systemctl restart mysqld</p></blockquote><h4 id="6、添加远程登录用户"><a href="#6、添加远程登录用户" class="headerlink" title="6、添加远程登录用户"></a>6、添加远程登录用户</h4><p>默认只允许root帐户在本地登录，如果要在其它机器上连接mysql，必须修改root允许远程连接：</p><p>授权方式：</p><p>例如，你想root使用123456从任何主机连接到mysql服务器。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos; IDENTIFIED BY &apos;123456&apos; WITH GRANT OPTION;</span><br><span class="line">mysql&gt;FLUSH RIVILEGES</span><br></pre></td></tr></table></figure><p>如果你想允许用户jack从ip为10.10.50.127的主机连接到mysql服务器，并使用654321作为密码:</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> mysql&gt;GRANT ALL PRIVILEGES ON *.* TO &apos;jack&apos;@’10.10.50.127’ IDENTIFIED BY &apos;654321&apos; WITH GRANT OPTION;</span><br><span class="line">mysql&gt;FLUSH RIVILEGES</span><br></pre></td></tr></table></figure><p>或者添加一个允许远程连接的帐户，为了安全起见，我添加一个新的帐户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO &apos;yangxin&apos;@&apos;%&apos; IDENTIFIED BY &apos;Yangxin0917!&apos; WITH GRANT OPTION;</span><br></pre></td></tr></table></figure><h4 id="7、配置默认编码为utf8"><a href="#7、配置默认编码为utf8" class="headerlink" title="7、配置默认编码为utf8"></a>7、配置默认编码为utf8</h4><p>修改/etc/my.cnf配置文件，在[mysqld]下添加编码配置，如下所示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">character_set_server=utf8</span><br><span class="line">init_connect=&apos;SET NAMES utf8&apos;</span><br></pre></td></tr></table></figure><p>重新启动mysql服务，查看数据库默认编码如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &apos;%character%&apos;;</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| Variable_name            | Value                      |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| character_set_client     | utf8                       |</span><br><span class="line">| character_set_connection | utf8                       |</span><br><span class="line">| character_set_database   | latin1                     |</span><br><span class="line">| character_set_filesystem | binary                     |</span><br><span class="line">| character_set_results    | utf8                       |</span><br><span class="line">| character_set_server     | latin1                     |</span><br><span class="line">| character_set_system     | utf8                       |</span><br><span class="line">| character_sets_dir       | /usr/share/mysql/charsets/ |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure></p><h4 id="默认配置文件路径"><a href="#默认配置文件路径" class="headerlink" title="默认配置文件路径"></a>默认配置文件路径</h4><p>配置文件：<code>/etc/my.cnf</code><br>日志文件：<code>/var/log//var/log/mysqld.log</code><br>服务启动脚本：<code>/usr/lib/systemd/system/mysqld.service</code><br>socket文件：<code>/var/run/mysqld/mysqld.pid</code></p><p>参考:<a href="http://www.linuxidc.com/Linux/2016-09/135288.htm" target="_blank" rel="noopener">http://www.linuxidc.com/Linux/2016-09/135288.htm</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;CentOS7上YUM安装MySQL5-7&quot;&gt;&lt;a href=&quot;#CentOS7上YUM安装MySQL5-7&quot; class=&quot;headerlink&quot; title=&quot;CentOS7上YUM安装MySQL5.7&quot;&gt;&lt;/a&gt;CentOS7上YUM安装MySQL5.7&lt;/
      
    
    </summary>
    
      <category term="centos" scheme="http://www.yaosansi.com/categories/centos/"/>
    
    
      <category term="centos" scheme="http://www.yaosansi.com/tags/centos/"/>
    
      <category term="yum" scheme="http://www.yaosansi.com/tags/yum/"/>
    
      <category term="mysql" scheme="http://www.yaosansi.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7上使nginx支持PHP</title>
    <link href="http://www.yaosansi.com/post/nginx-php-config-on-centos/"/>
    <id>http://www.yaosansi.com/post/nginx-php-config-on-centos/</id>
    <published>2017-05-26T03:34:09.000Z</published>
    <updated>2017-12-30T16:12:24.795Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CentOS7上使nginx支持PHP"><a href="#CentOS7上使nginx支持PHP" class="headerlink" title="CentOS7上使nginx支持PHP"></a>CentOS7上使nginx支持PHP</h3><h4 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    phpinfo();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="Nginx访问PHP文件的File-not-found"><a href="#Nginx访问PHP文件的File-not-found" class="headerlink" title="Nginx访问PHP文件的File not found"></a>Nginx访问PHP文件的File not found</h4><p>这个错误很常见，原有有下面两面几种</p><ul><li><ol><li>php-fpm找不到SCRIPT_FILENAME里执行的php文件</li></ol></li><li><ol><li>php-fpm不能访问所执行的php，也就是权限问题</li></ol></li></ul><h5 id="第一种情况"><a href="#第一种情况" class="headerlink" title="第一种情况"></a>第一种情况</h5><p>更改配置文件nginx.conf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name;</span><br></pre></td></tr></table></figure></p><p>替换成下面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br></pre></td></tr></table></figure></p><p>然后重新加载nginx配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/nginx reload</span><br></pre></td></tr></table></figure></p><h5 id="第二种情况"><a href="#第二种情况" class="headerlink" title="第二种情况"></a>第二种情况</h5><p>两种解决方法：<br>第一种，就是把你root文件夹设为其他用户允许<br>第二种，找到你的php-fpm的配置文件，找到下面这段，把apache替换成你要的用户组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">; RPM: apache Choosed to be able to access some dir as httpd </span><br><span class="line">user = apache </span><br><span class="line">; RPM: Keep a group allowed to write in log dir. </span><br><span class="line">group = apache</span><br></pre></td></tr></table></figure><h4 id="正确配置Nginx-PHP"><a href="#正确配置Nginx-PHP" class="headerlink" title="正确配置Nginx+PHP"></a>正确配置Nginx+PHP</h4><h5 id="网上错误或是坏味道的配置"><a href="#网上错误或是坏味道的配置" class="headerlink" title="网上错误或是坏味道的配置"></a>网上错误或是坏味道的配置</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name foo.com;</span><br><span class="line"></span><br><span class="line">    root /path;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        index index.html index.htm index.php;</span><br><span class="line"></span><br><span class="line">        if (!-e $request_filename) &#123;</span><br><span class="line">            rewrite . /index.php last;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        include fastcgi_params;</span><br><span class="line">        fastcgi_param SCRIPT_FILENAME /path$fastcgi_script_name;</span><br><span class="line">        fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">        fastcgi_index index.php;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="正确的配置-使用try-files"><a href="#正确的配置-使用try-files" class="headerlink" title="正确的配置-使用try_files:"></a>正确的配置-使用try_files:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name foo.com;</span><br><span class="line"></span><br><span class="line">    root /path;</span><br><span class="line">    index index.html index.htm index.php;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        try_files $uri $uri/ /index.php$is_args$args;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        try_files $uri =404;</span><br><span class="line"></span><br><span class="line">        include fastcgi.conf;</span><br><span class="line">        fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>详见: <a href="https://huoding.com/2013/10/23/290" target="_blank" rel="noopener">https://huoding.com/2013/10/23/290</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;CentOS7上使nginx支持PHP&quot;&gt;&lt;a href=&quot;#CentOS7上使nginx支持PHP&quot; class=&quot;headerlink&quot; title=&quot;CentOS7上使nginx支持PHP&quot;&gt;&lt;/a&gt;CentOS7上使nginx支持PHP&lt;/h3&gt;&lt;h4 i
      
    
    </summary>
    
      <category term="centos" scheme="http://www.yaosansi.com/categories/centos/"/>
    
    
      <category term="centos" scheme="http://www.yaosansi.com/tags/centos/"/>
    
      <category term="nginx" scheme="http://www.yaosansi.com/tags/nginx/"/>
    
      <category term="php" scheme="http://www.yaosansi.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7使用YUM安装PHP</title>
    <link href="http://www.yaosansi.com/post/install-php-yum-on-centos/"/>
    <id>http://www.yaosansi.com/post/install-php-yum-on-centos/</id>
    <published>2017-05-25T11:18:17.000Z</published>
    <updated>2017-12-30T16:18:55.925Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CentOS7使用YUM安装PHP7"><a href="#CentOS7使用YUM安装PHP7" class="headerlink" title="CentOS7使用YUM安装PHP7"></a>CentOS7使用YUM安装PHP7</h3><p>安装或升级PHP版本，使用yum命令及webtatic库</p><h4 id="卸载已安装PHP"><a href="#卸载已安装PHP" class="headerlink" title="卸载已安装PHP"></a>卸载已安装PHP</h4><p>更新之前查看当前PHP版本避免重复更新</p><blockquote><p><code># php -v</code></p></blockquote><p>检查当前PHP的安装包</p><blockquote><p><code># yum list installed | grep php</code></p></blockquote><p>完全移除当前PHP安装包以免起冲突</p><blockquote><p><code># yum remove php*</code></p></blockquote><h4 id="PHP-软件源"><a href="#PHP-软件源" class="headerlink" title="PHP 软件源"></a>PHP 软件源</h4><p>默认的yum源无法升级PHP，需要添加第三方yum源，我们选择webtatic库</p><p>CentOs 5.x</p><blockquote><p>rpm -Uvh <a href="http://mirror.webtatic.com/yum/el5/latest.rpm" target="_blank" rel="noopener">http://mirror.webtatic.com/yum/el5/latest.rpm</a></p></blockquote><p>CentOs 6.x</p><blockquote><p>rpm -Uvh <a href="http://mirror.webtatic.com/yum/el6/latest.rpm" target="_blank" rel="noopener">http://mirror.webtatic.com/yum/el6/latest.rpm</a></p></blockquote><p>CentOs 7.X</p><blockquote><p>rpm -Uvh <a href="https://mirror.webtatic.com/yum/el7/epel-release.rpm" target="_blank" rel="noopener">https://mirror.webtatic.com/yum/el7/epel-release.rpm</a></p><p>rpm -Uvh <a href="https://mirror.webtatic.com/yum/el7/webtatic-release.rpm" target="_blank" rel="noopener">https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</a></p></blockquote><p>小提示</p><blockquote><p>如果安装错误：<br><code>error: Failed dependencies:</code><br><code>epel-release &gt;= 7 is needed by webtatic-release-7-3.noarch</code><br>需要先安装epel-release。</p></blockquote><h5 id="安装epel-release"><a href="#安装epel-release" class="headerlink" title="安装epel-release"></a>安装epel-release</h5><p>通过命令：</p><blockquote><p>rpm -ivh <a href="http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm" target="_blank" rel="noopener">http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm</a></p></blockquote><p>成功安装。</p><h5 id="安装PHP7源"><a href="#安装PHP7源" class="headerlink" title="安装PHP7源"></a>安装PHP7源</h5><p>终端再次运行如下命令：</p><blockquote><p>rpm -Uvh <a href="https://mirror.webtatic.com/yum/el7/webtatic-release.rpm" target="_blank" rel="noopener">https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</a></p></blockquote><h4 id="安装-PHP"><a href="#安装-PHP" class="headerlink" title="安装 PHP"></a>安装 PHP</h4><h5 id="查看yum源是否有php7-1安装包"><a href="#查看yum源是否有php7-1安装包" class="headerlink" title="查看yum源是否有php7.1安装包"></a>查看yum源是否有php7.1安装包</h5><blockquote><p>yum list php71</p></blockquote><h5 id="安装php及相关插件"><a href="#安装php及相关插件" class="headerlink" title="安装php及相关插件"></a>安装php及相关插件</h5><h6 id="安装php7-0"><a href="#安装php7-0" class="headerlink" title="安装php7.0"></a>安装php7.0</h6><blockquote><p>yum install -y php70w.x86_64 php70w-cli.x86_64 php70w-common.x86_64 php70w-gd.x86_64 php70w-ldap.x86_64 php70w-mbstring.x86_64 php70w-mcrypt.x86_64 php70w-mysql.x86_64 php70w-pdo.x86_64 php70w-fpm</p></blockquote><p>其他版本php安装<br>如果想安装php5.5或者5.6版本，将上面的php70w替换为php55w或者php56w就可以了。</p><h6 id="安装php7-1"><a href="#安装php7-1" class="headerlink" title="安装php7.1"></a>安装php7.1</h6><blockquote><p>yum install -y php71w-fpm php71w-opcache php71w-cli php71w-gd php71w-imap php71w-mysqlnd php71w-mbstring php71w-mcrypt php71w-pdo php71w-pecl-apcu php71w-pecl-mongodb php71w-pecl-redis php71w-pgsql php71w-xml php71w-xmlrpc php71w-devel mod_php71w</p></blockquote><h5 id="查看当前php版本"><a href="#查看当前php版本" class="headerlink" title="查看当前php版本"></a>查看当前php版本</h5><blockquote><p>php -v</p></blockquote><h5 id="开启php-fpm服务"><a href="#开启php-fpm服务" class="headerlink" title="开启php-fpm服务"></a>开启php-fpm服务</h5><blockquote><p>systemctl start php-fpm.service<br>systemctl enable php-fpm.service </p></blockquote><p>更多资料</p><blockquote><p><a href="https://webtatic.com/packages/php71/" target="_blank" rel="noopener">https://webtatic.com/packages/php71/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;CentOS7使用YUM安装PHP7&quot;&gt;&lt;a href=&quot;#CentOS7使用YUM安装PHP7&quot; class=&quot;headerlink&quot; title=&quot;CentOS7使用YUM安装PHP7&quot;&gt;&lt;/a&gt;CentOS7使用YUM安装PHP7&lt;/h3&gt;&lt;p&gt;安装或升级P
      
    
    </summary>
    
      <category term="centos" scheme="http://www.yaosansi.com/categories/centos/"/>
    
    
      <category term="centos" scheme="http://www.yaosansi.com/tags/centos/"/>
    
      <category term="yum" scheme="http://www.yaosansi.com/tags/yum/"/>
    
      <category term="php" scheme="http://www.yaosansi.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7使用YUM安装nginx</title>
    <link href="http://www.yaosansi.com/post/install-nginx-yum-on-centos/"/>
    <id>http://www.yaosansi.com/post/install-nginx-yum-on-centos/</id>
    <published>2017-05-23T09:31:18.000Z</published>
    <updated>2017-12-30T16:19:01.230Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CentOS7使用YUM安装nginx"><a href="#CentOS7使用YUM安装nginx" class="headerlink" title="CentOS7使用YUM安装nginx"></a>CentOS7使用YUM安装nginx</h3><p>centos7系统库中默认是没有nginx的rpm包的，所以我们自己需要先更新下rpm依赖库</p><h4 id="1-使用yum安装nginx需要包括nginx的库，安装nginx的库"><a href="#1-使用yum安装nginx需要包括nginx的库，安装nginx的库" class="headerlink" title="1. 使用yum安装nginx需要包括nginx的库，安装nginx的库"></a>1. 使用yum安装nginx需要包括nginx的库，安装nginx的库</h4><blockquote><p><code>#rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</code></p></blockquote><h4 id="2-使用下面命令安装nginx"><a href="#2-使用下面命令安装nginx" class="headerlink" title="2.使用下面命令安装nginx"></a>2.使用下面命令安装nginx</h4><blockquote><p><code>#yum install nginx</code></p></blockquote><h4 id="3-启动nginx"><a href="#3-启动nginx" class="headerlink" title="3.启动nginx"></a>3.启动nginx</h4><blockquote><p><code>#systemctl start nginx.service</code><br><code>#systemctl enable nginx.service</code></p></blockquote><h3 id="nginx-无域名IP直接无法访问"><a href="#nginx-无域名IP直接无法访问" class="headerlink" title="nginx 无域名IP直接无法访问"></a>nginx 无域名IP直接无法访问</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server&#123; </span><br><span class="line">    listen 80 default_server; </span><br><span class="line">    server_name _; </span><br><span class="line">    return 444; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;CentOS7使用YUM安装nginx&quot;&gt;&lt;a href=&quot;#CentOS7使用YUM安装nginx&quot; class=&quot;headerlink&quot; title=&quot;CentOS7使用YUM安装nginx&quot;&gt;&lt;/a&gt;CentOS7使用YUM安装nginx&lt;/h3&gt;&lt;p&gt;ce
      
    
    </summary>
    
      <category term="centos" scheme="http://www.yaosansi.com/categories/centos/"/>
    
    
      <category term="centos" scheme="http://www.yaosansi.com/tags/centos/"/>
    
      <category term="yum" scheme="http://www.yaosansi.com/tags/yum/"/>
    
      <category term="nginx" scheme="http://www.yaosansi.com/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7挂载硬盘</title>
    <link href="http://www.yaosansi.com/post/mount-disk-on-centos/"/>
    <id>http://www.yaosansi.com/post/mount-disk-on-centos/</id>
    <published>2017-05-20T01:12:05.000Z</published>
    <updated>2018-01-02T04:10:47.025Z</updated>
    
    <content type="html"><![CDATA[<h3 id="挂载硬盘"><a href="#挂载硬盘" class="headerlink" title="挂载硬盘"></a>挂载硬盘</h3><blockquote><p>本文仅适用于使用 <code>fdisk</code> 命令对一个不大于 <code>2 TB</code> 的数据盘执行分区操作。如果需要分区的数据盘大于 <code>2 TB</code>，请参考 <a href="https://help.aliyun.com/document_detail/34377.html?spm=5176.doc25426.2.4.yV1HGb" target="_blank" rel="noopener">阿里云-32TB 块存储分区</a>。</p></blockquote><h4 id="查看新磁盘"><a href="#查看新磁盘" class="headerlink" title="查看新磁盘"></a>查看新磁盘</h4><p>查看硬盘</p><blockquote><p>df -h</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@sfdsfsdf ]# df -h</span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/vda1        99G   18G   77G  19% /</span><br><span class="line">devtmpfs        3.9G     0  3.9G   0% /dev</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /dev/shm</span><br><span class="line">tmpfs           3.9G  644K  3.9G   1% /run</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /sys/fs/cgroup</span><br><span class="line">tmpfs           783M     0  783M   0% /run/user/0</span><br></pre></td></tr></table></figure><h4 id="1-查找未挂载的硬盘"><a href="#1-查找未挂载的硬盘" class="headerlink" title="1. 查找未挂载的硬盘"></a>1. 查找未挂载的硬盘</h4><blockquote><p>[root@cgsl ]# fdisk –l</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Disk /dev/vda: 42.9 GB, 42949672960 bytes, 83886080 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x0008d73a</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/vda1   *        2048    83884031    41940992   83  Linux</span><br><span class="line"></span><br><span class="line">Disk /dev/vdb: 107.4 GB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line"></span><br><span class="line"># 注意看这里：这个就是新的硬盘</span><br><span class="line"># 记下/dev/vdb 这个名称</span><br><span class="line"># 注意阿里云不同的硬盘可能名称不同，如,高效盘:vdb开头 SSD:xvdb</span><br></pre></td></tr></table></figure><p>找到新添加的磁盘的编号为/dev/vdb</p><blockquote><p>注：</p><ul><li>如果您的数据盘显示的是 dev/xvd?，表示您使用的是非 I/O 优化实例。</li><li>其中 ? 是 a−z 的任一个字母。</li></ul></blockquote><h4 id="2-创建硬盘分区"><a href="#2-创建硬盘分区" class="headerlink" title="2. 创建硬盘分区"></a>2. 创建硬盘分区</h4><blockquote><p>使用 fdisk /dev/vdb</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ fdisk /dev/vdb</span><br><span class="line"></span><br><span class="line">Welcome to fdisk (util-linux 2.23.2).</span><br><span class="line"></span><br><span class="line">Changes will remain in memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write command.</span><br><span class="line"></span><br><span class="line">Device does not contain a recognized partition table</span><br><span class="line">Building a new DOS disklabel with disk identifier 0x774b38c4.</span><br></pre></td></tr></table></figure><blockquote><p>输入n<br>Command (m for help):n</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Partition type:</span><br><span class="line">   p   primary (0 primary, 0 extended, 4 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default p):</span><br></pre></td></tr></table></figure><blockquote><p>输入p</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Partition number (1-4): 1</span><br></pre></td></tr></table></figure><blockquote><p>回车</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">First sector (2048-209715199, default 2048):</span><br></pre></td></tr></table></figure><blockquote><p>回车</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Using default value 2048</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (2048-209715199, default 209715199):</span><br></pre></td></tr></table></figure><blockquote><p>回车</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Using default value 209715199</span><br><span class="line">Partition 1 of type Linux and of size 100 GiB is set</span><br></pre></td></tr></table></figure><blockquote><p>输入w<br>Command (m for help): w</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">The partition table has been altered!</span><br><span class="line"></span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">Syncing disks.</span><br></pre></td></tr></table></figure><h4 id="3-格式化分区"><a href="#3-格式化分区" class="headerlink" title="3. 格式化分区"></a>3. 格式化分区</h4><blockquote><p><code># mkfs.ext4 /dev/vdb</code> </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mke2fs 1.42.9 (28-Dec-2013)</span><br><span class="line">Filesystem label=</span><br><span class="line">OS type: Linux</span><br><span class="line">Block size=4096 (log=2)</span><br><span class="line">Fragment size=4096 (log=2)</span><br><span class="line">Stride=0 blocks, Stripe width=0 blocks</span><br><span class="line">6553600 inodes, 26214400 blocks</span><br><span class="line">1310720 blocks (5.00%) reserved for the super user</span><br><span class="line">First data block=0</span><br><span class="line">Maximum filesystem blocks=2174746624</span><br><span class="line">800 block groups</span><br><span class="line">32768 blocks per group, 32768 fragments per group</span><br><span class="line">8192 inodes per group</span><br><span class="line">Superblock backups stored on blocks: </span><br><span class="line">32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, </span><br><span class="line">4096000, 7962624, 11239424, 20480000, 23887872</span><br><span class="line"></span><br><span class="line">Allocating group tables: done                            </span><br><span class="line">Writing inode tables: done                            </span><br><span class="line">Creating journal (32768 blocks): done</span><br><span class="line">Writing superblocks and filesystem accounting information: done</span><br></pre></td></tr></table></figure><h4 id="4-建立挂载目录"><a href="#4-建立挂载目录" class="headerlink" title="4. 建立挂载目录"></a>4. 建立挂载目录</h4><blockquote><p><code># mkdir /data</code></p></blockquote><h4 id="5-挂载分区"><a href="#5-挂载分区" class="headerlink" title="5. 挂载分区"></a>5. 挂载分区</h4><blockquote><p><code># mount /dev/vdb /data</code></p></blockquote><h4 id="6-设置开机自动挂载"><a href="#6-设置开机自动挂载" class="headerlink" title="6. 设置开机自动挂载"></a>6. 设置开机自动挂载</h4><p>运行命令</p><blockquote><p> echo /dev/vdb1 /data ext4 defaults 0 0 &gt;&gt; /etc/fstab</p></blockquote><p>或手动编辑 <code>fstab</code>:</p><blockquote><p><code>vi /etc/fstab</code></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># </span><br><span class="line"># /etc/fstab </span><br><span class="line"># Created by anaconda on Tue May  3 13:48:10 2016 </span><br><span class="line"># </span><br><span class="line"># Accessible filesystems, by reference, are maintained under &apos;/dev/disk&apos; </span><br><span class="line"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info </span><br><span class="line"># </span><br><span class="line">UUID=80b9b662-0a1d-4e84-b07b-c1bf19e72d97 /                       ext4    defaults        1 1 </span><br><span class="line">/dev/vdb1  /data        ext4    defaults        0 0</span><br></pre></td></tr></table></figure><blockquote><p><code>/dev/vdb     /data    ext4    defaults     0 0</code></p></blockquote><h4 id="7-确认是否挂载成功"><a href="#7-确认是否挂载成功" class="headerlink" title="7. 确认是否挂载成功"></a>7. 确认是否挂载成功</h4><p>重启服务器</p><blockquote><p><code># reboot</code></p></blockquote><p>查看硬盘分区</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># df</span><br><span class="line">/dev/vdb            20635700    176196  19411268   1% /data</span><br></pre></td></tr></table></figure><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul><li><a href="https://help.aliyun.com/document_detail/25426.html?spm=5176.7738005.2.3.pMMKgY" target="_blank" rel="noopener">阿里云-Linux 格式化和挂载数据盘</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;挂载硬盘&quot;&gt;&lt;a href=&quot;#挂载硬盘&quot; class=&quot;headerlink&quot; title=&quot;挂载硬盘&quot;&gt;&lt;/a&gt;挂载硬盘&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;本文仅适用于使用 &lt;code&gt;fdisk&lt;/code&gt; 命令对一个不大于 &lt;code&gt;2 TB&lt;/
      
    
    </summary>
    
      <category term="centos" scheme="http://www.yaosansi.com/categories/centos/"/>
    
    
      <category term="centos" scheme="http://www.yaosansi.com/tags/centos/"/>
    
      <category term="mount" scheme="http://www.yaosansi.com/tags/mount/"/>
    
      <category term="disk" scheme="http://www.yaosansi.com/tags/disk/"/>
    
  </entry>
  
  <entry>
    <title>CentOS7更改SSH端口</title>
    <link href="http://www.yaosansi.com/post/change-ssh-port-on-centos/"/>
    <id>http://www.yaosansi.com/post/change-ssh-port-on-centos/</id>
    <published>2017-05-15T05:41:20.000Z</published>
    <updated>2017-12-30T16:19:23.674Z</updated>
    
    <content type="html"><![CDATA[<h3 id="更改SSH端口"><a href="#更改SSH端口" class="headerlink" title="更改SSH端口"></a>更改SSH端口</h3><h4 id="step1-修改-etc-ssh-sshd-config"><a href="#step1-修改-etc-ssh-sshd-config" class="headerlink" title="step1 修改/etc/ssh/sshd_config"></a>step1 修改/etc/ssh/sshd_config</h4><blockquote><p><code>vi /etc/ssh/sshd_config</code></p><p><code>#Port 22</code>       //这行去掉#号，防止配置不好以后不能远程登录，还得去机房修改，等修改以后的端口能使用以后在注释掉</p><p><code>Port 20000</code>    //下面添加这一行</p></blockquote><h4 id="step2-修改firewall配置"><a href="#step2-修改firewall配置" class="headerlink" title="step2 修改firewall配置"></a>step2 修改firewall配置</h4><p>firewall添加想要修改的ssh端口：</p><blockquote><p>firewall-cmd –zone=public –add-port=20000/tcp –permanent (permanent是保存配置，不然下次重启以后这次修改无效)</p></blockquote><p> reload firewall:</p><blockquote><p>firewall-cmd –reload</p></blockquote><p>查看添加端口是否成功，如果添加成功则会显示yes，否则no</p><blockquote><p>firewall-cmd –zone=public –query-port=20000/tcp</p></blockquote><h4 id="step3-修改SELinux"><a href="#step3-修改SELinux" class="headerlink" title="step3 修改SELinux"></a>step3 修改SELinux</h4><p>使用以下命令查看当前SElinux 允许的ssh端口：</p><blockquote><p>semanage port -l | grep ssh</p></blockquote><p>添加20000端口到 SELinux</p><blockquote><p>semanage port -a -t ssh_port_t -p tcp 20000</p></blockquote><p>然后确认一下是否添加进去</p><blockquote><p>semanage port -l | grep ssh</p></blockquote><p>如果成功会输出</p><blockquote><p>ssh_port_t                    tcp    20000, 22</p></blockquote><h4 id="step4-重启ssh"><a href="#step4-重启ssh" class="headerlink" title="step4 重启ssh"></a>step4 重启ssh</h4><blockquote><p>systemctl restart sshd.service</p></blockquote><h4 id="step5-测试新端口的ssh连接"><a href="#step5-测试新端口的ssh连接" class="headerlink" title="step5 测试新端口的ssh连接"></a>step5 测试新端口的ssh连接</h4><p>测试修改端口以后的ssh连接，如果成功则将step1里面的port 22 重新注释掉</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;更改SSH端口&quot;&gt;&lt;a href=&quot;#更改SSH端口&quot; class=&quot;headerlink&quot; title=&quot;更改SSH端口&quot;&gt;&lt;/a&gt;更改SSH端口&lt;/h3&gt;&lt;h4 id=&quot;step1-修改-etc-ssh-sshd-config&quot;&gt;&lt;a href=&quot;#step1
      
    
    </summary>
    
      <category term="centos" scheme="http://www.yaosansi.com/categories/centos/"/>
    
    
      <category term="ssh" scheme="http://www.yaosansi.com/tags/ssh/"/>
    
      <category term="port" scheme="http://www.yaosansi.com/tags/port/"/>
    
      <category term="centos" scheme="http://www.yaosansi.com/tags/centos/"/>
    
  </entry>
  
  <entry>
    <title>GIT log 中文乱码</title>
    <link href="http://www.yaosansi.com/post/git-log-chinese-garbled/"/>
    <id>http://www.yaosansi.com/post/git-log-chinese-garbled/</id>
    <published>2017-05-12T04:41:50.000Z</published>
    <updated>2017-12-30T16:19:55.359Z</updated>
    
    <content type="html"><![CDATA[<h3 id="git-log的中文乱码问题"><a href="#git-log的中文乱码问题" class="headerlink" title="git log的中文乱码问题"></a>git log的中文乱码问题</h3><p>系统软件版本：</p><ul><li>win10 1709</li><li>Git-2.15.1.2-64-bit</li></ul><p>解决方案：把Git控制台的默认输出改为gbk编码</p><p>打开git bush，运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global i18n.logoutputencoding utf-8</span><br></pre></td></tr></table></figure></p><blockquote><p>参考:<a href="http://www.pstips.net/question/5566.html" target="_blank" rel="noopener">http://www.pstips.net/question/5566.html</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;git-log的中文乱码问题&quot;&gt;&lt;a href=&quot;#git-log的中文乱码问题&quot; class=&quot;headerlink&quot; title=&quot;git log的中文乱码问题&quot;&gt;&lt;/a&gt;git log的中文乱码问题&lt;/h3&gt;&lt;p&gt;系统软件版本：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;w
      
    
    </summary>
    
      <category term="soft" scheme="http://www.yaosansi.com/categories/soft/"/>
    
    
      <category term="git" scheme="http://www.yaosansi.com/tags/git/"/>
    
      <category term="乱码" scheme="http://www.yaosansi.com/tags/%E4%B9%B1%E7%A0%81/"/>
    
      <category term="log" scheme="http://www.yaosansi.com/tags/log/"/>
    
  </entry>
  
  <entry>
    <title>使用FFmpeg将字幕文件集成到视频文件</title>
    <link href="http://www.yaosansi.com/post/ffmpeg-burn-subtitles-into-video/"/>
    <id>http://www.yaosansi.com/post/ffmpeg-burn-subtitles-into-video/</id>
    <published>2015-06-04T04:22:00.000Z</published>
    <updated>2017-12-30T15:57:29.662Z</updated>
    
    <content type="html"><![CDATA[<p><code>本文最后更新于：2015-05-25 13:12:00</code><br><code>原文：http://www.yaosansi.com/post/ffmpeg-burn-subtitles-into-video</code></p><p>向视频文件里添加字幕是件很常见的事，本文使用<a href="http://ffmpeg.org/" target="_blank" rel="noopener">FFmpeg</a>将字幕文件集成到视频文件里。</p><p><a href="http://www.yaosansi.com/post/ffmpeg-on-centos/">在CentOS上编译安装FFmpeg</a></p><a id="more"></a><h2 id="字幕文件转换"><a href="#字幕文件转换" class="headerlink" title="字幕文件转换"></a>字幕文件转换</h2><p>字幕文件有很多种，常见的有 <code>.srt</code> , <code>.ass</code> 文件等,下面使用FFmpeg进行相互转换。</p><p>将<code>.srt</code>文件转换成<code>.ass</code>文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i subtitle.srt subtitle.ass</span><br></pre></td></tr></table></figure><p>将<code>.ass</code>文件转换成<code>.srt</code>文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i subtitle.ass subtitle.srt</span><br></pre></td></tr></table></figure><h2 id="集成字幕，选择播放"><a href="#集成字幕，选择播放" class="headerlink" title="集成字幕，选择播放"></a>集成字幕，选择播放</h2><p>这种字幕集成比较简单，播放时需要在播放器中选择相应的字幕文件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.mp4 -i subtitles.srt -c:s mov_text -c:v copy -c:a copy output.mp4</span><br></pre></td></tr></table></figure><h2 id="嵌入SRT字幕到视频文件"><a href="#嵌入SRT字幕到视频文件" class="headerlink" title="嵌入SRT字幕到视频文件"></a>嵌入SRT字幕到视频文件</h2><h3 id="单独SRT字幕"><a href="#单独SRT字幕" class="headerlink" title="单独SRT字幕"></a>单独SRT字幕</h3><p>字幕文件为<code>subtitle.srt</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i video.avi -vf subtitles=subtitle.srt out.avi</span><br></pre></td></tr></table></figure><h3 id="嵌入在MKV等容器的字幕"><a href="#嵌入在MKV等容器的字幕" class="headerlink" title="嵌入在MKV等容器的字幕"></a>嵌入在MKV等容器的字幕</h3><p>将<code>video.mkv</code>中的字幕（默认）嵌入到<code>out.avi</code>文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i video.mkv -vf subtitles=video.mkv out.avi</span><br></pre></td></tr></table></figure><p>将<code>video.mkv</code>中的字幕（第二个）嵌入到<code>out.avi</code>文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i video.mkv -vf subtitles=video.mkv:si=1 out.avi</span><br></pre></td></tr></table></figure><h2 id="嵌入ASS字幕到视频文件"><a href="#嵌入ASS字幕到视频文件" class="headerlink" title="嵌入ASS字幕到视频文件"></a>嵌入ASS字幕到视频文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i video.avi -vf &quot;ass=subtitle.ass&quot; out.avi</span><br></pre></td></tr></table></figure><h2 id="不能加载fontconfig文件"><a href="#不能加载fontconfig文件" class="headerlink" title="不能加载fontconfig文件"></a>不能加载fontconfig文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Fontconfig error: Cannot load default config file</span><br><span class="line">[Parsed_ass_0 @ 0000000002bfa3e0] No usable fontconfig configuration file found,</span><br><span class="line"> using fallback.</span><br><span class="line">Fontconfig error: Cannot load default config file</span><br></pre></td></tr></table></figure><p>出现类似错误的原因是无法加载字体配置文件。</p><h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><p>FFmpeg使用的默认字体文件是使用系统环境变量中对应的文件位置。</p><p>默认文件名：<code>fonts.conf</code></p><p>环境变量 <code>FONTCONFIG_FILE</code> 可以覆盖默认配置文件<br>环境变量 <code>FONTCONFIG_PATH</code> 可以覆盖默认配置文件目录</p><p>Linux 默认配置文件：<a href="http://www.stata.com/support/faqs/unix/fonts.conf/lux64/fonts.conf" title="fonts.conf" target="_blank" rel="noopener">fonts.conf</a></p><p>使用步骤：</p><ol><li>以root权限登录</li><li>建立<code>/etc/fonts</code>目录</li><li>下载<code>fonts.conf</code>文件到<code>/etc/fonts</code>目录</li><li>设置<code>fonts.conf</code>文件权限为可读</li></ol><h3 id="Linux-Mac-系统"><a href="#Linux-Mac-系统" class="headerlink" title="Linux/Mac 系统"></a>Linux/Mac 系统</h3><p>在~/.bashrc 最后添加：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export FONTCONFIG_PATH=/opt/X11/lib/X11/fontconfig</span><br></pre></td></tr></table></figure><p>使之有效：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><p>编辑 <code>/opt/X11/lib/X11/fontconfig/fonts.conf</code> 在字体目录添加 <code>/Library/Fonts</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Font directory list --&gt;</span><br><span class="line"></span><br><span class="line">  &lt;dir&gt;/opt/X11/share/fonts&lt;/dir&gt;</span><br><span class="line">  &lt;dir&gt;/usr/X11R6/lib/X11/fonts&lt;/dir&gt;</span><br><span class="line">  &lt;dir&gt;~/.fonts&lt;/dir&gt;</span><br><span class="line">  &lt;dir&gt;/Library/Fonts&lt;/dir&gt;</span><br></pre></td></tr></table></figure><h3 id="Windows系统"><a href="#Windows系统" class="headerlink" title="Windows系统"></a>Windows系统</h3><p>在系统环境变量中添加：</p><p>name: <code>FONTCONFIG_PATH</code><br>value: <code>J:/ffmpeg</code> (我本机<code>ffmpeg</code>目录，与<code>fonts.conf</code>同目录即可)</p><p>将<code>fonts.conf</code>文件放至上述指定目录。</p><p>以下为<a href="http://www.yaosansi.com" title="yaosansi">yaosansi</a>使用的<code>fonts.conf</code>文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE fontconfig SYSTEM &quot;fonts.dtd&quot;&gt;</span><br><span class="line">&lt;!-- /etc/fonts/fonts.conf file to configure system font access --&gt;</span><br><span class="line">&lt;fontconfig&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">DO NOT EDIT THIS FILE.</span><br><span class="line">IT WILL BE REPLACED WHEN FONTCONFIG IS UPDATED.</span><br><span class="line">LOCAL CHANGES BELONG IN &apos;local.conf&apos;.</span><br><span class="line"></span><br><span class="line">The intent of this standard configuration file is to be adequate for</span><br><span class="line">most environments.  If you have a reasonably normal environment and</span><br><span class="line">have found problems with this configuration, they are probably</span><br><span class="line">things that others will also want fixed.  Please submit any</span><br><span class="line">problems to the fontconfig bugzilla system located at fontconfig.org</span><br><span class="line"></span><br><span class="line">Note that the normal &apos;make install&apos; procedure for fontconfig is to</span><br><span class="line">replace any existing fonts.conf file with the new version.  Place</span><br><span class="line">any local customizations in local.conf which this file references.</span><br><span class="line"></span><br><span class="line">Keith Packard</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Font directory list --&gt;</span><br><span class="line"></span><br><span class="line">&lt;dir&gt;C:/Windows/Fonts&lt;/dir&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">  Accept deprecated &apos;mono&apos; alias, replacing it with &apos;monospace&apos;</span><br><span class="line">--&gt;</span><br><span class="line">&lt;match target=&quot;pattern&quot;&gt;</span><br><span class="line">&lt;test qual=&quot;any&quot; name=&quot;family&quot;&gt;</span><br><span class="line">&lt;string&gt;mono&lt;/string&gt;</span><br><span class="line">&lt;/test&gt;</span><br><span class="line">&lt;edit name=&quot;family&quot; mode=&quot;assign&quot;&gt;</span><br><span class="line">&lt;string&gt;monospace&lt;/string&gt;</span><br><span class="line">&lt;/edit&gt;</span><br><span class="line">&lt;/match&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">  Accept alternate &apos;sans serif&apos; spelling, replacing it with &apos;sans-serif&apos;</span><br><span class="line">--&gt;</span><br><span class="line">&lt;match target=&quot;pattern&quot;&gt;</span><br><span class="line">&lt;test qual=&quot;any&quot; name=&quot;family&quot;&gt;</span><br><span class="line">&lt;string&gt;sans serif&lt;/string&gt;</span><br><span class="line">&lt;/test&gt;</span><br><span class="line">&lt;edit name=&quot;family&quot; mode=&quot;assign&quot;&gt;</span><br><span class="line">&lt;string&gt;sans-serif&lt;/string&gt;</span><br><span class="line">&lt;/edit&gt;</span><br><span class="line">&lt;/match&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">  Accept deprecated &apos;sans&apos; alias, replacing it with &apos;sans-serif&apos;</span><br><span class="line">--&gt;</span><br><span class="line">&lt;match target=&quot;pattern&quot;&gt;</span><br><span class="line">&lt;test qual=&quot;any&quot; name=&quot;family&quot;&gt;</span><br><span class="line">&lt;string&gt;sans&lt;/string&gt;</span><br><span class="line">&lt;/test&gt;</span><br><span class="line">&lt;edit name=&quot;family&quot; mode=&quot;assign&quot;&gt;</span><br><span class="line">&lt;string&gt;sans-serif&lt;/string&gt;</span><br><span class="line">&lt;/edit&gt;</span><br><span class="line">&lt;/match&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">  Mark common families with their generics so we&apos;ll get</span><br><span class="line">  something reasonable</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">  Serif faces</span><br><span class="line"> --&gt;</span><br><span class="line">&lt;alias&gt;</span><br><span class="line">&lt;family&gt;Times New Roman&lt;/family&gt;</span><br><span class="line">&lt;default&gt;&lt;family&gt;serif&lt;/family&gt;&lt;/default&gt;</span><br><span class="line">&lt;/alias&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">  If the font still has no generic name, add sans-serif</span><br><span class="line"> --&gt;</span><br><span class="line">&lt;match target=&quot;pattern&quot;&gt;</span><br><span class="line">&lt;test qual=&quot;all&quot; name=&quot;family&quot; compare=&quot;not_eq&quot;&gt;</span><br><span class="line">&lt;string&gt;sans-serif&lt;/string&gt;</span><br><span class="line">&lt;/test&gt;</span><br><span class="line">&lt;test qual=&quot;all&quot; name=&quot;family&quot; compare=&quot;not_eq&quot;&gt;</span><br><span class="line">&lt;string&gt;serif&lt;/string&gt;</span><br><span class="line">&lt;/test&gt;</span><br><span class="line">&lt;test qual=&quot;all&quot; name=&quot;family&quot; compare=&quot;not_eq&quot;&gt;</span><br><span class="line">&lt;string&gt;monospace&lt;/string&gt;</span><br><span class="line">&lt;/test&gt;</span><br><span class="line">&lt;edit name=&quot;family&quot; mode=&quot;append_last&quot;&gt;</span><br><span class="line">&lt;string&gt;sans-serif&lt;/string&gt;</span><br><span class="line">&lt;/edit&gt;</span><br><span class="line">&lt;/match&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line"> AMT provides metric and shape compatible fonts for these three web font</span><br><span class="line"> families.</span><br><span class="line"> --&gt;</span><br><span class="line"> &lt;alias&gt;</span><br><span class="line">&lt;family&gt;Times New Roman&lt;/family&gt;</span><br><span class="line">&lt;accept&gt;&lt;family&gt;Thorndale AMT&lt;/family&gt;&lt;/accept&gt;</span><br><span class="line">&lt;/alias&gt;</span><br><span class="line"> &lt;alias&gt;</span><br><span class="line">&lt;family&gt;Arial&lt;/family&gt;</span><br><span class="line">&lt;accept&gt;&lt;family&gt;Albany AMT&lt;/family&gt;&lt;/accept&gt;</span><br><span class="line">&lt;/alias&gt;</span><br><span class="line"> &lt;alias&gt;</span><br><span class="line">&lt;family&gt;Courier New&lt;/family&gt;</span><br><span class="line">&lt;accept&gt;&lt;family&gt;Cumberland AMT&lt;/family&gt;&lt;/accept&gt;</span><br><span class="line">&lt;/alias&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!--</span><br><span class="line">  Some Asian fonts misadvertise themselves as monospaced when</span><br><span class="line">  in fact they are dual-spaced (half and full).  This makes</span><br><span class="line">  FreeType very confused as it forces all widths to match.</span><br><span class="line">  Undo this magic by disabling the width forcing code --&gt;</span><br><span class="line">&lt;match target=&quot;font&quot;&gt;</span><br><span class="line">&lt;test name=&quot;family&quot;&gt;&lt;string&gt;GulimChe&lt;/string&gt;&lt;/test&gt;</span><br><span class="line">&lt;edit name=&quot;globaladvance&quot;&gt;&lt;bool&gt;false&lt;/bool&gt;&lt;/edit&gt;</span><br><span class="line">&lt;/match&gt;</span><br><span class="line"></span><br><span class="line">&lt;match target=&quot;font&quot;&gt;</span><br><span class="line">&lt;test name=&quot;family&quot;&gt;&lt;string&gt;DotumChe&lt;/string&gt;&lt;/test&gt;</span><br><span class="line">&lt;edit name=&quot;globaladvance&quot;&gt;&lt;bool&gt;false&lt;/bool&gt;&lt;/edit&gt;</span><br><span class="line">&lt;/match&gt;</span><br><span class="line"></span><br><span class="line">&lt;match target=&quot;font&quot;&gt;</span><br><span class="line">&lt;test name=&quot;family&quot;&gt;&lt;string&gt;BatangChe&lt;/string&gt;&lt;/test&gt;</span><br><span class="line">&lt;edit name=&quot;globaladvance&quot;&gt;&lt;bool&gt;false&lt;/bool&gt;&lt;/edit&gt;</span><br><span class="line">&lt;/match&gt;</span><br><span class="line"></span><br><span class="line">&lt;match target=&quot;font&quot;&gt;</span><br><span class="line">&lt;test name=&quot;family&quot;&gt;&lt;string&gt;GungsuhChe&lt;/string&gt;&lt;/test&gt;</span><br><span class="line">&lt;edit name=&quot;globaladvance&quot;&gt;&lt;bool&gt;false&lt;/bool&gt;&lt;/edit&gt;</span><br><span class="line">&lt;/match&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;config&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">  These are the default Unicode chars that are expected to be blank</span><br><span class="line">  in fonts.  All other blank chars are assumed to be broken and</span><br><span class="line">  won&apos;t appear in the resulting charsets</span><br><span class="line"> --&gt;</span><br><span class="line">&lt;blank&gt;</span><br><span class="line">&lt;int&gt;0x0020&lt;/int&gt;&lt;!-- SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x00A0&lt;/int&gt;&lt;!-- NO-BREAK SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x00AD&lt;/int&gt;&lt;!-- SOFT HYPHEN --&gt;</span><br><span class="line">&lt;int&gt;0x034F&lt;/int&gt;&lt;!-- COMBINING GRAPHEME JOINER --&gt;</span><br><span class="line">&lt;int&gt;0x0600&lt;/int&gt;&lt;!-- ARABIC NUMBER SIGN --&gt;</span><br><span class="line">&lt;int&gt;0x0601&lt;/int&gt;&lt;!-- ARABIC SIGN SANAH --&gt;</span><br><span class="line">&lt;int&gt;0x0602&lt;/int&gt;&lt;!-- ARABIC FOOTNOTE MARKER --&gt;</span><br><span class="line">&lt;int&gt;0x0603&lt;/int&gt;&lt;!-- ARABIC SIGN SAFHA --&gt;</span><br><span class="line">&lt;int&gt;0x06DD&lt;/int&gt;&lt;!-- ARABIC END OF AYAH --&gt;</span><br><span class="line">&lt;int&gt;0x070F&lt;/int&gt;&lt;!-- SYRIAC ABBREVIATION MARK --&gt;</span><br><span class="line">&lt;int&gt;0x115F&lt;/int&gt;&lt;!-- HANGUL CHOSEONG FILLER --&gt;</span><br><span class="line">&lt;int&gt;0x1160&lt;/int&gt;&lt;!-- HANGUL JUNGSEONG FILLER --&gt;</span><br><span class="line">&lt;int&gt;0x1680&lt;/int&gt;&lt;!-- OGHAM SPACE MARK --&gt;</span><br><span class="line">&lt;int&gt;0x17B4&lt;/int&gt;&lt;!-- KHMER VOWEL INHERENT AQ --&gt;</span><br><span class="line">&lt;int&gt;0x17B5&lt;/int&gt;&lt;!-- KHMER VOWEL INHERENT AA --&gt;</span><br><span class="line">&lt;int&gt;0x180E&lt;/int&gt;&lt;!-- MONGOLIAN VOWEL SEPARATOR --&gt;</span><br><span class="line">&lt;int&gt;0x2000&lt;/int&gt;&lt;!-- EN QUAD --&gt;</span><br><span class="line">&lt;int&gt;0x2001&lt;/int&gt;&lt;!-- EM QUAD --&gt;</span><br><span class="line">&lt;int&gt;0x2002&lt;/int&gt;&lt;!-- EN SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x2003&lt;/int&gt;&lt;!-- EM SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x2004&lt;/int&gt;&lt;!-- THREE-PER-EM SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x2005&lt;/int&gt;&lt;!-- FOUR-PER-EM SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x2006&lt;/int&gt;&lt;!-- SIX-PER-EM SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x2007&lt;/int&gt;&lt;!-- FIGURE SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x2008&lt;/int&gt;&lt;!-- PUNCTUATION SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x2009&lt;/int&gt;&lt;!-- THIN SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x200A&lt;/int&gt;&lt;!-- HAIR SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x200B&lt;/int&gt;&lt;!-- ZERO WIDTH SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x200C&lt;/int&gt;&lt;!-- ZERO WIDTH NON-JOINER --&gt;</span><br><span class="line">&lt;int&gt;0x200D&lt;/int&gt;&lt;!-- ZERO WIDTH JOINER --&gt;</span><br><span class="line">&lt;int&gt;0x200E&lt;/int&gt;&lt;!-- LEFT-TO-RIGHT MARK --&gt;</span><br><span class="line">&lt;int&gt;0x200F&lt;/int&gt;&lt;!-- RIGHT-TO-LEFT MARK --&gt;</span><br><span class="line">&lt;int&gt;0x2028&lt;/int&gt;&lt;!-- LINE SEPARATOR --&gt;</span><br><span class="line">&lt;int&gt;0x2029&lt;/int&gt;&lt;!-- PARAGRAPH SEPARATOR --&gt;</span><br><span class="line">&lt;int&gt;0x202A&lt;/int&gt;&lt;!-- LEFT-TO-RIGHT EMBEDDING --&gt;</span><br><span class="line">&lt;int&gt;0x202B&lt;/int&gt;&lt;!-- RIGHT-TO-LEFT EMBEDDING --&gt;</span><br><span class="line">&lt;int&gt;0x202C&lt;/int&gt;&lt;!-- POP DIRECTIONAL FORMATTING --&gt;</span><br><span class="line">&lt;int&gt;0x202D&lt;/int&gt;&lt;!-- LEFT-TO-RIGHT OVERRIDE --&gt;</span><br><span class="line">&lt;int&gt;0x202E&lt;/int&gt;&lt;!-- RIGHT-TO-LEFT OVERRIDE --&gt;</span><br><span class="line">&lt;int&gt;0x202F&lt;/int&gt;&lt;!-- NARROW NO-BREAK SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x205F&lt;/int&gt;&lt;!-- MEDIUM MATHEMATICAL SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x2060&lt;/int&gt;&lt;!-- WORD JOINER --&gt;</span><br><span class="line">&lt;int&gt;0x2061&lt;/int&gt;&lt;!-- FUNCTION APPLICATION --&gt;</span><br><span class="line">&lt;int&gt;0x2062&lt;/int&gt;&lt;!-- INVISIBLE TIMES --&gt;</span><br><span class="line">&lt;int&gt;0x2063&lt;/int&gt;&lt;!-- INVISIBLE SEPARATOR --&gt;</span><br><span class="line">&lt;int&gt;0x206A&lt;/int&gt;&lt;!-- INHIBIT SYMMETRIC SWAPPING --&gt;</span><br><span class="line">&lt;int&gt;0x206B&lt;/int&gt;&lt;!-- ACTIVATE SYMMETRIC SWAPPING --&gt;</span><br><span class="line">&lt;int&gt;0x206C&lt;/int&gt;&lt;!-- INHIBIT ARABIC FORM SHAPING --&gt;</span><br><span class="line">&lt;int&gt;0x206D&lt;/int&gt;&lt;!-- ACTIVATE ARABIC FORM SHAPING --&gt;</span><br><span class="line">&lt;int&gt;0x206E&lt;/int&gt;&lt;!-- NATIONAL DIGIT SHAPES --&gt;</span><br><span class="line">&lt;int&gt;0x206F&lt;/int&gt;&lt;!-- NOMINAL DIGIT SHAPES --&gt;</span><br><span class="line">&lt;int&gt;0x3000&lt;/int&gt;&lt;!-- IDEOGRAPHIC SPACE --&gt;</span><br><span class="line">&lt;int&gt;0x3164&lt;/int&gt;&lt;!-- HANGUL FILLER --&gt;</span><br><span class="line">&lt;int&gt;0xFEFF&lt;/int&gt;&lt;!-- ZERO WIDTH NO-BREAK SPACE --&gt;</span><br><span class="line">&lt;int&gt;0xFFA0&lt;/int&gt;&lt;!-- HALFWIDTH HANGUL FILLER --&gt;</span><br><span class="line">&lt;int&gt;0xFFF9&lt;/int&gt;&lt;!-- INTERLINEAR ANNOTATION ANCHOR --&gt;</span><br><span class="line">&lt;int&gt;0xFFFA&lt;/int&gt;&lt;!-- INTERLINEAR ANNOTATION SEPARATOR --&gt;</span><br><span class="line">&lt;int&gt;0xFFFB&lt;/int&gt;&lt;!-- INTERLINEAR ANNOTATION TERMINATOR --&gt;</span><br><span class="line">&lt;/blank&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">  Rescan configuration every 30 seconds when FcFontSetList is called</span><br><span class="line"> --&gt;</span><br><span class="line">&lt;rescan&gt;</span><br><span class="line">&lt;int&gt;30&lt;/int&gt;</span><br><span class="line">&lt;/rescan&gt;</span><br><span class="line">&lt;/config&gt;</span><br><span class="line"></span><br><span class="line">&lt;/fontconfig&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="http://www.ffmpeg.org/" target="_blank" rel="noopener">http://www.ffmpeg.org/</a></li><li><a href="https://trac.ffmpeg.org/wiki/HowToBurnSubtitlesIntoVideo" target="_blank" rel="noopener">https://trac.ffmpeg.org/wiki/HowToBurnSubtitlesIntoVideo</a></li><li><a href="http://ffmpeg.org/ffmpeg-all.html#toc-subtitles-1" target="_blank" rel="noopener">http://ffmpeg.org/ffmpeg-all.html#toc-subtitles-1</a></li><li><a href="http://en.wikipedia.org/wiki/SubStation_Alpha#Advanced_SubStation_Alpha" target="_blank" rel="noopener">http://en.wikipedia.org/wiki/SubStation_Alpha#Advanced_SubStation_Alpha</a></li><li><a href="http://ffmpeg.org/ffmpeg-filters.html#ass" target="_blank" rel="noopener">http://ffmpeg.org/ffmpeg-filters.html#ass</a></li><li><a href="http://www.stata.com/support/faqs/unix/fontconfig-error/" target="_blank" rel="noopener">http://www.stata.com/support/faqs/unix/fontconfig-error/</a></li><li><a href="http://freedesktop.org/software/fontconfig/fontconfig-user.html" target="_blank" rel="noopener">http://freedesktop.org/software/fontconfig/fontconfig-user.html</a></li><li><a href="http://www.freedesktop.org/wiki/Software/fontconfig/" target="_blank" rel="noopener">http://www.freedesktop.org/wiki/Software/fontconfig/</a></li><li><a href="http://www.stata.com/support/faqs/unix/fonts.conf/lux64/fonts.conf" target="_blank" rel="noopener">http://www.stata.com/support/faqs/unix/fonts.conf/lux64/fonts.conf</a></li><li><a href="http://blog.neten.de/posts/2013/10/06/use-ffmpeg-to-burn-subtitles-into-the-video/" target="_blank" rel="noopener">http://blog.neten.de/posts/2013/10/06/use-ffmpeg-to-burn-subtitles-into-the-video/</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;本文最后更新于：2015-05-25 13:12:00&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/ffmpeg-burn-subtitles-into-video&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;向视频文件里添加字幕是件很常见的事，本文使用&lt;a href=&quot;http://ffmpeg.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;FFmpeg&lt;/a&gt;将字幕文件集成到视频文件里。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.yaosansi.com/post/ffmpeg-on-centos/&quot;&gt;在CentOS上编译安装FFmpeg&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="video" scheme="http://www.yaosansi.com/categories/video/"/>
    
    
      <category term="ffmepg" scheme="http://www.yaosansi.com/tags/ffmepg/"/>
    
      <category term="windows" scheme="http://www.yaosansi.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>在CentOS上编译安装FFmpeg</title>
    <link href="http://www.yaosansi.com/post/ffmpeg-on-centos/"/>
    <id>http://www.yaosansi.com/post/ffmpeg-on-centos/</id>
    <published>2015-05-22T07:22:00.000Z</published>
    <updated>2017-12-30T15:57:40.321Z</updated>
    
    <content type="html"><![CDATA[<p><code>本文最后更新于：2015-05-25 13:12:00</code><br><code>原文：http://www.yaosansi.com/post/ffmpeg-on-centos</code></p><p>在CentOS编译安装ffmpeg比较麻烦，以前也搞过多次，由于博客调整，特重新记录一下，以备不时之需。</p><a id="more"></a><h1 id="使用yum安装ffmpeg和相关软件"><a href="#使用yum安装ffmpeg和相关软件" class="headerlink" title="使用yum安装ffmpeg和相关软件"></a>使用yum安装ffmpeg和相关软件</h1><h2 id="快速安装-ffmpeg"><a href="#快速安装-ffmpeg" class="headerlink" title="快速安装 ffmpeg"></a>快速安装 ffmpeg</h2><p>直接安装： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install ffmpeg ffmpeg-devel</span><br></pre></td></tr></table></figure><p>若没有找到相应包，需要先加入要应的包。</p><p>将下列代码命名为 <code>dag.repo</code> 放在 <code>/etc/yum.repos.d</code> 目录 下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[dag]</span><br><span class="line">name=Dag RPM Repository for Red Hat Enterprise Linux</span><br><span class="line">baseurl=http://apt.sw.be/redhat/el$releasever/en/$basearch/dag</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure><p>然后再执行上方的安装命令。</p><h2 id="安装-ffmpeg-php-扩展"><a href="#安装-ffmpeg-php-扩展" class="headerlink" title="安装 ffmpeg-php 扩展"></a>安装 ffmpeg-php 扩展</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget /path/to/this/file/ffmpeg-php-0.5.2.1.tbz2</span><br><span class="line">tar -xjf ffmpeg-0.5.2.1.tbz2</span><br><span class="line">phpize</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="修改-php-ini-文件"><a href="#修改-php-ini-文件" class="headerlink" title="修改 php.ini 文件"></a>修改 php.ini 文件</h3><p>安装完成后，将会在<code>/usr/local/lib/php/extensions/no-debug-non-zts-20060613/ffmpeg.so</code> 看到php扩展文件。</p><p>打开<code>php.ini</code>文件,加入下面两行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[ffmpeg]</span><br><span class="line">extension=ffmpeg.so</span><br></pre></td></tr></table></figure><p>重启WEB服务器。使用phpinfo即可看到ffmpeg相关信息。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// #test.php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">phpinfo()</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="php-使用方法"><a href="#php-使用方法" class="headerlink" title="php 使用方法"></a>php 使用方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$extension = &quot;ffmpeg&quot;;</span><br><span class="line">$extension_soname = $extension . &quot;.&quot; . PHP_SHLIB_SUFFIX;</span><br><span class="line">$extension_fullname = PHP_EXTENSION_DIR . &quot;/&quot; . $extension_soname;</span><br><span class="line"></span><br><span class="line">// load extension</span><br><span class="line">if(!extension_loaded($extension)) &#123;</span><br><span class="line">    dl($extension_soname) or die(&quot;Can&apos;t load extension $extension_fullname\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h2 id="安装-Mplayer-和-Mencoder"><a href="#安装-Mplayer-和-Mencoder" class="headerlink" title="安装 Mplayer 和 Mencoder"></a>安装 Mplayer 和 Mencoder</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install mplayer mencoder</span><br></pre></td></tr></table></figure><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p>常见问题及解决方案请参考这里：<a href="http://www.mysql-apache-php.com/ffmpeg-install.htm" target="_blank" rel="noopener">http://www.mysql-apache-php.com/ffmpeg-install.htm</a></p><h1 id="自行编译安装-ffmpeg"><a href="#自行编译安装-ffmpeg" class="headerlink" title="自行编译安装 ffmpeg"></a>自行编译安装 ffmpeg</h1><h2 id="安装依赖项"><a href="#安装依赖项" class="headerlink" title="安装依赖项"></a>安装依赖项</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install autoconf automake gcc gcc-c++ git libtool make nasm pkgconfig zlib-devel</span><br></pre></td></tr></table></figure><h2 id="安装相应软件包"><a href="#安装相应软件包" class="headerlink" title="安装相应软件包"></a>安装相应软件包</h2><p>可以建立目录存放软件包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/ffmpeg_sources</span><br></pre></td></tr></table></figure><p>注意：以下软件包请有选择的安装，如果不需要请在<code>./configure</code>时移除或关闭相关选项</p><h3 id="安装-yasm"><a href="#安装-yasm" class="headerlink" title="安装 yasm"></a>安装 yasm</h3><p>Yasm是一个完全重写的NASM汇编。目前，它支持x86和AMD64指令集。 x264 和 FFmpeg都使用Yasm.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources</span><br><span class="line">git clone --depth 1 git://github.com/yasm/yasm.git</span><br><span class="line">cd yasm</span><br><span class="line">autoreconf -fiv</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --bindir=&quot;$HOME/bin&quot;</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure><p>或<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz</span><br><span class="line">tar zxf yasm-1.3.0.tar.gz</span><br><span class="line">cd yasm-1.3.0</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --bindir=&quot;$HOME/bin&quot;</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br><span class="line">. ~/.bash_profile</span><br></pre></td></tr></table></figure></p><h3 id="安装-x264"><a href="#安装-x264" class="headerlink" title="安装 x264"></a>安装 x264</h3><p>H.264 编码器。<a href="http://trac.ffmpeg.org/wiki/Encode/H.264" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/Encode/H.264</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources</span><br><span class="line">git clone --depth 1 git://git.videolan.org/x264</span><br><span class="line">cd x264</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --bindir=&quot;$HOME/bin&quot; --enable-static</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><p>或<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget ftp://ftp.videolan.org/pub/x264/snapshots/last_x264.tar.bz2</span><br><span class="line">tar jxf last_x264.tar.bz2</span><br><span class="line">cd x264-snapshot-20130311-2245/</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --bindir=&quot;$HOME/bin&quot; --enable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><p>需要<code>ffmpeg</code>配置<code>./configure --enable-gpl --enable-libx264</code></p><p>注：由于libx264的code有GPL信息，所以，支持libx264时，需要–enable-gpl，ffmpeg在license方面还是比我们国内的人更重视</p><h3 id="安装-x265"><a href="#安装-x265" class="headerlink" title="安装 x265"></a>安装 x265</h3><p>H.265/HEVC编码器.<a href="http://trac.ffmpeg.org/wiki/Encode/H.265" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/Encode/H.265</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources</span><br><span class="line">hg clone https://bitbucket.org/multicoreware/x265</span><br><span class="line">cd ~/ffmpeg_sources/x265/build/linux</span><br><span class="line">cmake -G &quot;Unix Makefiles&quot; -DCMAKE_INSTALL_PREFIX=&quot;$HOME/ffmpeg_build&quot; -DENABLE_SHARED:bool=off ../../source</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>需要<code>ffmpeg</code>配置<code>./configure --enable-gpl --enable-libx265</code></p><h3 id="安装-libfdk-aac"><a href="#安装-libfdk-aac" class="headerlink" title="安装 libfdk_aac"></a>安装 libfdk_aac</h3><p>AAC音频编码器，Fraunhofer AAC library<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources</span><br><span class="line">git clone --depth 1 git://git.code.sf.net/p/opencore-amr/fdk-aac</span><br><span class="line">cd fdk-aac</span><br><span class="line">autoreconf -fiv</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --enable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><p>需要<code>ffmpeg</code>配置<code>--enable-libfdk_aac</code> ，如果指定了<code>--enable-gpl</code>还要配置<code>--enable-nonfree</code></p><h3 id="安装-libmp3lame"><a href="#安装-libmp3lame" class="headerlink" title="安装 libmp3lame"></a>安装 libmp3lame</h3><p>Mp3音频编码器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http://iweb.dl.sourceforge.net/project/lame/lame/3.99/lame-3.99.5.tar.gz</span><br><span class="line">tar zxf lame-3.99.5.tar.gz</span><br><span class="line">cd lame-3.99.5</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --bindir=&quot;$HOME/bin&quot; --enable-shared --enable-nasm</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><p>需要<code>ffmpeg</code>配置<code>--enable-libmp3lame</code> </p><h3 id="安装-libopus"><a href="#安装-libopus" class="headerlink" title="安装 libopus"></a>安装 libopus</h3><p>Opus 音频编解码器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources</span><br><span class="line">git clone git://git.opus-codec.org/opus.git</span><br><span class="line">cd opus</span><br><span class="line">autoreconf -fiv</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --disable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><p>或<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http://downloads.xiph.org/releases/opus/opus-1.0.3.tar.gz</span><br><span class="line">tar zxf opus-1.0.3.tar.gz</span><br><span class="line">cd opus-1.0.3</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --enable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><p>需要<code>ffmpeg</code>配置<code>--enable-libopus</code> </p><h3 id="安装-libogg库"><a href="#安装-libogg库" class="headerlink" title="安装 libogg库"></a>安装 libogg库</h3><p>libogg是Ogg流库，libtheora、libvorbis需要libogg库，speex需要它。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources</span><br><span class="line">curl -O http://downloads.xiph.org/releases/ogg/libogg-1.3.2.tar.gz</span><br><span class="line">tar xzvf libogg-1.3.2.tar.gz</span><br><span class="line">cd libogg-1.3.2</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --disable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><h3 id="安装-libvorbis库"><a href="#安装-libvorbis库" class="headerlink" title="安装 libvorbis库"></a>安装 libvorbis库</h3><p>Vorbis音频编码器，需要libogg库。<a href="http://trac.ffmpeg.org/wiki/CompilationGuide/Centos#libogg" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/CompilationGuide/Centos#libogg</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources</span><br><span class="line">curl -O http://downloads.xiph.org/releases/vorbis/libvorbis-1.3.4.tar.gz</span><br><span class="line">tar xzvf libvorbis-1.3.4.tar.gz</span><br><span class="line">cd libvorbis-1.3.4</span><br><span class="line">LDFLAGS=&quot;-L$HOME/ffmeg_build/lib&quot; CPPFLAGS=&quot;-I$HOME/ffmpeg_build/include&quot; ./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --with-ogg=&quot;$HOME/ffmpeg_build&quot; --disable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><p>需要<code>ffmpeg</code>配置<code>--enable-libvorbis</code> </p><h3 id="安装-libvpx"><a href="#安装-libvpx" class="headerlink" title="安装 libvpx"></a>安装 libvpx</h3><p>VP8/VP9视频编码器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources</span><br><span class="line">git clone --depth 1 http://git.chromium.org/webm/libvpx.git</span><br><span class="line">cd libvpx</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --enable-examples</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make clean</span><br></pre></td></tr></table></figure><p>需要<code>ffmpeg</code>配置<code>--enable-libvpx</code> </p><h2 id="编译安装-ffmpeg"><a href="#编译安装-ffmpeg" class="headerlink" title="编译安装 ffmpeg"></a>编译安装 ffmpeg</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources</span><br><span class="line">git clone --depth 1 git://source.ffmpeg.org/ffmpeg</span><br><span class="line">cd ffmpeg</span><br><span class="line">PKG_CONFIG_PATH=&quot;$HOME/ffmpeg_build/lib/pkgconfig&quot; ./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --extra-cflags=&quot;-I$HOME/ffmpeg_build/include&quot; --extra-ldflags=&quot;-L$HOME/ffmpeg_build/lib&quot; --bindir=&quot;$HOME/bin&quot; --pkg-config-flags=&quot;--static&quot; --enable-gpl --enable-nonfree --enable-libfdk_aac --enable-libfreetype --enable-libmp3lame --enable-libopus --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libx265</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br><span class="line">hash -r</span><br></pre></td></tr></table></figure><p><strong>注：</strong></p><ul><li>编译完成后<code>ffmpeg</code>,<code>ffprobe</code>,<code>ffserver</code>,<code>lame</code>,<code>x264</code>都可以使用。</li><li>编译安装时可以参考Windows Build：<a href="http://ffmpeg.zeranoe.com/builds/" target="_blank" rel="noopener">http://ffmpeg.zeranoe.com/builds/</a></li><li>如果还需要持续更新请保留<code>ffmpeg_sources</code>目录。</li></ul><p>##其它可选软件包</p><h3 id="安装-OpenCORE-AMR"><a href="#安装-OpenCORE-AMR" class="headerlink" title="安装 OpenCORE AMR"></a>安装 OpenCORE AMR</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://iweb.dl.sourceforge.net/project/opencore-amr/opencore-amr/opencore-amr-0.1.3.tar.gz</span><br><span class="line">tar zxf opencore-amr-0.1.3.tar.gz</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot;  –enable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>需要<code>ffmpeg</code>配置<code>--enable-libopencore-amrnb</code> 和/或 <code>--enable-libopencore-amrwb</code></p><h3 id="安装-VisualOn-AAC"><a href="#安装-VisualOn-AAC" class="headerlink" title="安装 VisualOn AAC"></a>安装 VisualOn AAC</h3><p>注：github的tag和master版均无法autoconf，用zeranoe版代替</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget wget http://ffmpeg.zeranoe.com/builds/source/external_libraries/vo-aacenc-0.1.3.tar.xz</span><br><span class="line">xz -d vo-aacenc-0.1.3.tar.xz</span><br><span class="line">tar xf vo-aacenc-0.1.3.tar</span><br><span class="line">cd vo-aacenc-0.1.3</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; </span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>也可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://iweb.dl.sourceforge.net/project/opencore-amr/vo-aacenc/vo-aacenc-0.1.3.tar.gz</span><br></pre></td></tr></table></figure></p><p>需要<code>ffmpeg</code>配置<code>--enable-libvo-aacenc</code> </p><h3 id="安装-VisualOn-AMR-WB"><a href="#安装-VisualOn-AMR-WB" class="headerlink" title="安装 VisualOn AMR-WB"></a>安装 VisualOn AMR-WB</h3><p>注：github的tag和master版均无法autoconf，用zeranoe版代替</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://ffmpeg.zeranoe.com/builds/source/external_libraries/vo-amrwbenc-0.1.2.tar.xz</span><br><span class="line">xz -d vo-amrwbenc-0.1.2.tar.xz</span><br><span class="line">tar xf vo-amrwbenc-0.1.2.tar</span><br><span class="line">cd vo-amrwbenc-0.1.2</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot;</span><br></pre></td></tr></table></figure><p>需要<code>ffmpeg</code>配置<code>--enable-libvo-amrwbenc</code> </p><h3 id="安装-frei0r"><a href="#安装-frei0r" class="headerlink" title="安装 frei0r"></a>安装 frei0r</h3><p>先安装新版autoconf，这会覆盖掉系统中的旧版本哦<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://ftp.gnu.org/gnu/autoconf/autoconf-2.69.tar.gz</span><br><span class="line">tar zxf autoconf-2.69.tar.gz</span><br><span class="line">cd autoconf-2.69</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; </span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://files.dyne.org/frei0r/releases/frei0r-plugins-1.4.tar.gz</span><br><span class="line">tar zxf frei0r-plugins-1.4.tar.gz</span><br><span class="line">cd frei0r-plugins-1.4</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; </span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="安装-gnutls"><a href="#安装-gnutls" class="headerlink" title="安装 gnutls"></a>安装 gnutls</h3><blockquote><p>注意：/etc/ld.so.conf要加上lib64。并且不要使用yum remove gnutls gnutls-devel</p></blockquote><p>首先安装nettle：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.lysator.liu.se/~nisse/archive/nettle-2.5.tar.gz</span><br><span class="line">tar zxf nettle-2.5.tar.gz</span><br><span class="line">cd nettle-2.5</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot;  –enable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>然后安装gnutls新版：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget ftp://ftp.gnutls.org/gcrypt/gnutls/v3.1/gnutls-3.1.9.1.tar.xz</span><br><span class="line">xz -d gnutls-3.1.9.1.tar.xz</span><br><span class="line">tar xf gnutls-3.1.9.1.tar</span><br><span class="line">cd gnutls-3.1.9.1</span><br><span class="line">PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig:/usr/lib64/pkgconfig:/usr/local/lib/pkgconfig:/usr/lib/pkgconfig ./configure –enable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="安装-rtmpdump"><a href="#安装-rtmpdump" class="headerlink" title="安装 rtmpdump"></a>安装 rtmpdump</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://rtmpdump.mplayerhq.hu/download/rtmpdump-2.3.tgz</span><br><span class="line">tar zxf rtmpdump-2.3.tgz</span><br><span class="line">cd rtmpdump-2.3</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="安装-schroedinger"><a href="#安装-schroedinger" class="headerlink" title="安装 schroedinger"></a>安装 schroedinger</h3><p>注：先安装好orc库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http://code.entropywave.com/download/orc/orc-0.4.17.tar.gz</span><br><span class="line">tar zxf orc-0.4.17.tar.gz</span><br><span class="line">cd orc-0.4.17</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; </span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">/sbin/ldconfig</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://diracvideo.org/download/schroedinger/schroedinger-1.0.11.tar.gz</span><br><span class="line">tar zxf schroedinger-1.0.11.tar.gz</span><br><span class="line">cd schroedinger-1.0.11</span><br><span class="line">PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig:/usr/lib64/pkgconfig:/usr/local/lib/pkgconfig:/usr/lib/pkgconfig ./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="安装-soxr"><a href="#安装-soxr" class="headerlink" title="安装 soxr"></a>安装 soxr</h3><p>注：新版libsoxr貌似与当前ffmpeg不兼容，用旧版<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yum install -y xz</span><br><span class="line">wget http://hivelocity.dl.sourceforge.net/project/soxr/soxr-0.1.0-Source.tar.xz</span><br><span class="line">xz -d soxr-0.1.0-Source.tar.xz</span><br><span class="line">tar xf soxr-0.1.0-Source.tar</span><br><span class="line">cd soxr-0.1.0-Source</span><br><span class="line">./go</span><br><span class="line">cd Release/</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">/sbin/ldconfig</span><br></pre></td></tr></table></figure></p><h3 id="安装-speex"><a href="#安装-speex" class="headerlink" title="安装 speex"></a>安装 speex</h3><p>音频编码解码器。需要安装libogg库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install speex-devel</span><br></pre></td></tr></table></figure></p><p>或<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://downloads.xiph.org/releases/speex/speex-1.2rc1.tar.gz</span><br><span class="line">tar zxf speex-1.2rc1.tar.gz</span><br><span class="line">cd speex-1.2rc1</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; </span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>ffmpeg <code>./configure</code> 添加 <code>--enable-libspeex</code></p><h3 id="安装-libfreetype"><a href="#安装-libfreetype" class="headerlink" title="安装 libfreetype"></a>安装 libfreetype</h3><p>字体呈现库，使用<code>drawtext</code> <a href="http://ffmpeg.org/ffmpeg-filters.html#drawtext-1" target="_blank" rel="noopener">http://ffmpeg.org/ffmpeg-filters.html#drawtext-1</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install freetype-devel</span><br></pre></td></tr></table></figure></p><p>ffmpeg <code>./configure</code> 添加 <code>--enable-libfreetype</code></p><h3 id="安装-libsdl库"><a href="#安装-libsdl库" class="headerlink" title="安装 libsdl库"></a>安装 libsdl库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.libsdl.org/release/SDL-1.2.15.tar.gz</span><br><span class="line">tar zxf SDL-1.2.15.tar.gz</span><br><span class="line">cd SDL-1.2.15</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; </span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">/sbin/ldconfig</span><br></pre></td></tr></table></figure><h3 id="安装-theora"><a href="#安装-theora" class="headerlink" title="安装 theora"></a>安装 theora</h3><p>Theora视频编码器，需要需要libogg，libvorbis和libsdl库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://downloads.xiph.org/releases/theora/libtheora-1.1.1.tar.bz2</span><br><span class="line">tar zjf libtheora-1.1.1.tar.bz2</span><br><span class="line">./configure  --prefix=&quot;$HOME/ffmpeg_build&quot; --with-ogg=&quot;$HOME/ffmpeg_build&quot; --disable-examples --enable-shared --disable-sdltest --disable-vorbistest</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><p>ffmpeg <code>./configure</code> 添加 <code>--enable-libtheora</code></p><h3 id="安装-twolame"><a href="#安装-twolame" class="headerlink" title="安装 twolame"></a>安装 twolame</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget http://downloads.sourceforge.net/twolame/twolame-0.3.13.tar.gz</span><br><span class="line">tar zxf twolame-0.3.13</span><br><span class="line">.tar.gz</span><br><span class="line">cd twolame-0.3.13</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; </span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">/sbin/ldconfig</span><br></pre></td></tr></table></figure><h3 id="安装-xvid"><a href="#安装-xvid" class="headerlink" title="安装 xvid"></a>安装 xvid</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget http://downloads.xvid.org/downloads/xvidcore-1.3.2.tar.gz</span><br><span class="line">tar zxf xvidcore-1.3.2.tar.gz</span><br><span class="line">cd xvidcore</span><br><span class="line">cd build/generic</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; </span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h2 id="更新FFmpeg及相关组件"><a href="#更新FFmpeg及相关组件" class="headerlink" title="更新FFmpeg及相关组件"></a>更新FFmpeg及相关组件</h2><h3 id="更新依赖项"><a href="#更新依赖项" class="headerlink" title="更新依赖项"></a>更新依赖项</h3><p>删除旧文件，更新依赖项<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ~/ffmpeg_build ~/bin/&#123;ffmpeg,ffprobe,ffserver,lame,vsyasm,x264,yasm,ytasm&#125;</span><br><span class="line"># yum install autoconf automake cmake gcc gcc-c++ git libtool make mercurial nasm pkgconfig zlib-devel</span><br></pre></td></tr></table></figure></p><h3 id="更新-x264"><a href="#更新-x264" class="headerlink" title="更新 x264"></a>更新 x264</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources/x264</span><br><span class="line">make distclean</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><p>然后运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --bindir=&quot;$HOME/bin&quot; --enable-static</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><h3 id="更新-x265"><a href="#更新-x265" class="headerlink" title="更新 x265"></a>更新 x265</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources/x265</span><br><span class="line">rm -rf ~/ffmpeg_sources/x265/build/linux/*</span><br><span class="line">hg update</span><br><span class="line">cd ~/ffmpeg_sources/x265/build/linux</span><br></pre></td></tr></table></figure><p>然后运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cmake -G &quot;Unix Makefiles&quot; -DCMAKE_INSTALL_PREFIX=&quot;$HOME/ffmpeg_build&quot; -DENABLE_SHARED:bool=off ../../source</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><h3 id="更新-libfdk-aac"><a href="#更新-libfdk-aac" class="headerlink" title="更新 libfdk_aac"></a>更新 libfdk_aac</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources/libfdk_aac</span><br><span class="line">make distclean</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><p>然后运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd fdk-aac</span><br><span class="line">autoreconf -fiv</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --disable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br></pre></td></tr></table></figure></p><h3 id="更新-libvpx"><a href="#更新-libvpx" class="headerlink" title="更新 libvpx"></a>更新 libvpx</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources/libvpx</span><br><span class="line">make clean</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><p>然后运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd libvpx</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --disable-examples</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make clean</span><br></pre></td></tr></table></figure></p><h3 id="更新FFmpeg"><a href="#更新FFmpeg" class="headerlink" title="更新FFmpeg"></a>更新FFmpeg</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ffmpeg_sources/ffmpeg</span><br><span class="line">make distclean</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><p>然后运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd ffmpeg</span><br><span class="line">PKG_CONFIG_PATH=&quot;$HOME/ffmpeg_build/lib/pkgconfig&quot; ./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --extra-cflags=&quot;-I$HOME/ffmpeg_build/include&quot; --extra-ldflags=&quot;-L$HOME/ffmpeg_build/lib&quot; --bindir=&quot;$HOME/bin&quot; --pkg-config-flags=&quot;--static&quot; --enable-gpl --enable-nonfree --enable-libfdk_aac --enable-libfreetype --enable-libmp3lame --enable-libopus --enable-libvorbis --enable-libvpx --enable-libx264 --enable-libx265</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">make distclean</span><br><span class="line">hash -r</span><br></pre></td></tr></table></figure></p><h2 id="还原所有本文安装内容"><a href="#还原所有本文安装内容" class="headerlink" title="还原所有本文安装内容"></a>还原所有本文安装内容</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ~/ffmpeg_build ~/ffmpeg_sources ~/bin/&#123;ffmpeg,ffprobe,ffserver,lame,vsyasm,x264,yasm,ytasm&#125;</span><br><span class="line"># yum erase autoconf automake cmake gcc gcc-c++ git libtool mercurial nasm pkgconfig zlib-devel</span><br><span class="line">hash -r</span><br></pre></td></tr></table></figure><p>注：如安装其它软件包需要自行删除</p><h2 id="自动安装shell"><a href="#自动安装shell" class="headerlink" title="自动安装shell"></a>自动安装shell</h2><p><a href="https://gist.github.com/gboudreau/f24aed76b4cc91bfb2c1" target="_blank" rel="noopener">https://gist.github.com/gboudreau/f24aed76b4cc91bfb2c1</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"> </span><br><span class="line"># Based on instructions found here: http://wiki.razuna.com/display/ecp/FFMpeg+Installation+on+CentOS+and+RedHat#FFMpegInstallationonCentOSandRedHat-InstallX264</span><br><span class="line"> </span><br><span class="line">if [ &quot;`/usr/bin/whoami`&quot; != &quot;root&quot; ]; then</span><br><span class="line">    echo &quot;You need to execute this script as root.&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"> </span><br><span class="line">cat &gt; /etc/yum.repos.d/centos.repo&lt;&lt;EOF</span><br><span class="line">[centos]</span><br><span class="line">name=CentOS-6 – Base</span><br><span class="line">baseurl=http://mirror.centos.org/centos/6/os/x86_64/</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-6</span><br><span class="line">enabled=1</span><br><span class="line">priority=1</span><br><span class="line">protect=1</span><br><span class="line">includepkgs=SDL SDL-devel gsm gsm-devel libtheora theora-tools libdc1394 libdc1394-devel libraw1394-devel</span><br><span class="line">EOF</span><br><span class="line">rpm --import http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-6</span><br><span class="line"> </span><br><span class="line">rpm -Uhv http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el6.rf.x86_64.rpm</span><br><span class="line">yum -y update</span><br><span class="line"> </span><br><span class="line">yum -y install glibc gcc gcc-c++ autoconf automake libtool git make nasm pkgconfig</span><br><span class="line">yum -y install SDL-devel a52dec a52dec-devel alsa-lib-devel faac faac-devel faad2 faad2-devel</span><br><span class="line">yum -y install freetype-devel giflib gsm gsm-devel imlib2 imlib2-devel lame lame-devel libICE-devel libSM-devel libX11-devel</span><br><span class="line">yum -y install libXau-devel libXdmcp-devel libXext-devel libXrandr-devel libXrender-devel libXt-devel</span><br><span class="line">yum -y install libogg libvorbis vorbis-tools mesa-libGL-devel mesa-libGLU-devel xorg-x11-proto-devel zlib-devel</span><br><span class="line">yum -y install libtheora theora-tools</span><br><span class="line">yum -y install ncurses-devel</span><br><span class="line">yum -y install libdc1394 libdc1394-devel</span><br><span class="line">yum -y install amrnb-devel amrwb-devel opencore-amr-devel</span><br><span class="line"> </span><br><span class="line">cd /opt</span><br><span class="line">wget http://downloads.xvid.org/downloads/xvidcore-1.3.2.tar.gz</span><br><span class="line">tar xzvf xvidcore-1.3.2.tar.gz &amp;&amp; rm -f xvidcore-1.3.2.tar.gz</span><br><span class="line">cd xvidcore/build/generic</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; &amp;&amp; make &amp;&amp; make install</span><br><span class="line"> </span><br><span class="line">cd /opt</span><br><span class="line">wget http://downloads.xiph.org/releases/ogg/libogg-1.3.1.tar.gz</span><br><span class="line">tar xzvf libogg-1.3.1.tar.gz &amp;&amp; rm -f libogg-1.3.1.tar.gz</span><br><span class="line">cd libogg-1.3.1</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --disable-shared &amp;&amp; make &amp;&amp; make install</span><br><span class="line"> </span><br><span class="line">cd /opt</span><br><span class="line">wget http://downloads.xiph.org/releases/vorbis/libvorbis-1.3.4.tar.gz</span><br><span class="line">tar xzvf libvorbis-1.3.4.tar.gz &amp;&amp; rm -f libvorbis-1.3.4.tar.gz</span><br><span class="line">cd libvorbis-1.3.4</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --with-ogg=&quot;$HOME/ffmpeg_build&quot; --disable-shared &amp;&amp; make &amp;&amp; make install</span><br><span class="line"> </span><br><span class="line">cd /opt</span><br><span class="line">wget http://downloads.xiph.org/releases/theora/libtheora-1.1.1.tar.gz</span><br><span class="line">tar xzvf libtheora-1.1.1.tar.gz &amp;&amp; rm -f libtheora-1.1.1.tar.gz</span><br><span class="line">cd libtheora-1.1.1</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --with-ogg=&quot;$HOME/ffmpeg_build&quot; --disable-examples --disable-shared --disable-sdltest --disable-vorbistest &amp;&amp; make &amp;&amp; make install</span><br><span class="line"> </span><br><span class="line">cd /opt</span><br><span class="line">wget http://downloads.sourceforge.net/opencore-amr/vo-aacenc-0.1.2.tar.gz</span><br><span class="line">tar xzvf vo-aacenc-0.1.2.tar.gz &amp;&amp; rm -f vo-aacenc-0.1.2.tar.gz</span><br><span class="line">cd vo-aacenc-0.1.2</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --disable-shared &amp;&amp; make install</span><br><span class="line"> </span><br><span class="line">yum -y remove yasm</span><br><span class="line">cd /opt</span><br><span class="line">wget http://www.tortall.net/projects/yasm/releases/yasm-1.2.0.tar.gz</span><br><span class="line">tar xzfv yasm-1.2.0.tar.gz &amp;&amp; rm -f yasm-1.2.0.tar.gz</span><br><span class="line">cd yasm-1.2.0</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --bindir=&quot;$HOME/bin&quot; &amp;&amp; make install</span><br><span class="line">export &quot;PATH=$PATH:$HOME/bin&quot; </span><br><span class="line"> </span><br><span class="line">cd /opt</span><br><span class="line">git clone http://git.chromium.org/webm/libvpx.git</span><br><span class="line">cd libvpx</span><br><span class="line">git checkout tags/v1.3.0</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --disable-examples &amp;&amp; make &amp;&amp; make install</span><br><span class="line"> </span><br><span class="line">cd /opt</span><br><span class="line">git clone git://git.videolan.org/x264.git</span><br><span class="line">cd x264</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --bindir=&quot;$HOME/bin&quot; --enable-static &amp;&amp; make install</span><br><span class="line"> </span><br><span class="line">export LD_LIBRARY_PATH=/usr/local/lib/:$HOME/ffmpeg_build/lib/</span><br><span class="line">echo /usr/local/lib &gt;&gt; /etc/ld.so.conf.d/custom-libs.conf</span><br><span class="line">echo $HOME/ffmpeg_build/lib/ &gt;&gt; /etc/ld.so.conf.d/custom-libs.conf</span><br><span class="line">ldconfig</span><br><span class="line"> </span><br><span class="line">cd /opt</span><br><span class="line">git clone git://source.ffmpeg.org/ffmpeg.git</span><br><span class="line">cd ffmpeg</span><br><span class="line">git checkout release/2.2</span><br><span class="line">PKG_CONFIG_PATH=&quot;$HOME/ffmpeg_build/lib/pkgconfig&quot;</span><br><span class="line">export PKG_CONFIG_PATH</span><br><span class="line">./configure --prefix=&quot;$HOME/ffmpeg_build&quot; --extra-cflags=&quot;-I$HOME/ffmpeg_build/include&quot; --extra-ldflags=&quot;-L$HOME/ffmpeg_build/lib&quot; --bindir=&quot;$HOME/bin&quot; \</span><br><span class="line">--extra-libs=-ldl --enable-version3 --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libvpx --enable-libfaac \</span><br><span class="line">--enable-libmp3lame --enable-libtheora --enable-libvorbis --enable-libx264 --enable-libvo-aacenc --enable-libxvid --disable-ffplay \</span><br><span class="line">--enable-gpl --enable-postproc --enable-nonfree --enable-avfilter --enable-pthreads --arch=x86_64 &amp;&amp; make install</span><br><span class="line"> </span><br><span class="line"># Test the resulting ffmpeg binary</span><br><span class="line">cp $HOME/bin/ffmpeg /usr/bin/</span><br><span class="line">ffmpeg -v</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="http://ju.outofmemory.cn/entry/25624" target="_blank" rel="noopener">http://ju.outofmemory.cn/entry/25624</a></li><li><a href="http://ju.outofmemory.cn/entry/25625" target="_blank" rel="noopener">http://ju.outofmemory.cn/entry/25625</a></li><li><a href="http://ffmpeg.zeranoe.com/builds/" target="_blank" rel="noopener">http://ffmpeg.zeranoe.com/builds/</a></li><li><a href="http://blog.csdn.net/yasi_xi/article/details/18810707" target="_blank" rel="noopener">http://blog.csdn.net/yasi_xi/article/details/18810707</a></li><li><a href="http://www.mysql-apache-php.com/ffmpeg-install.htm" target="_blank" rel="noopener">http://www.mysql-apache-php.com/ffmpeg-install.htm</a></li><li><a href="http://ffmpeg-php.sourceforge.net/" target="_blank" rel="noopener">http://ffmpeg-php.sourceforge.net/</a></li><li><a href="http://inlet-media.de/flvtool2" target="_blank" rel="noopener">http://inlet-media.de/flvtool2</a></li><li><a href="http://lame.sourceforge.net/" target="_blank" rel="noopener">http://lame.sourceforge.net/</a></li><li><a href="http://www.mplayerhq.hu/design7/dload.html" target="_blank" rel="noopener">http://www.mplayerhq.hu/design7/dload.html</a></li><li><a href="http://flowplayer.org/" target="_blank" rel="noopener">http://flowplayer.org/</a></li><li><a href="http://www.mplayerhq.hu/DOCS/HTML/en/audio-codecs.html" target="_blank" rel="noopener">http://www.mplayerhq.hu/DOCS/HTML/en/audio-codecs.html</a></li><li><a href="http://www.webmasterpals.com/forumdisplay.php?f=6" target="_blank" rel="noopener">http://www.webmasterpals.com/forumdisplay.php?f=6</a></li><li><a href="http://trac.ffmpeg.org/wiki/CentosCompilationGuide#x264" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/CentosCompilationGuide#x264</a></li><li><a href="http://trac.ffmpeg.org/wiki/CentosCompilationGuide#libfdk_aac" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/CentosCompilationGuide#libfdk_aac</a></li><li><a href="http://trac.ffmpeg.org/wiki/CentosCompilationGuide#libvpx" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/CentosCompilationGuide#libvpx</a></li><li><a href="http://trac.ffmpeg.org/wiki/CentosCompilationGuide#FFmpeg" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/CentosCompilationGuide#FFmpeg</a></li><li><a href="http://trac.ffmpeg.org/wiki/x264EncodingGuide" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/x264EncodingGuide</a></li><li><a href="http://trac.ffmpeg.org/wiki/AACEncodingGuide" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/AACEncodingGuide</a></li><li><a href="http://trac.ffmpeg.org/wiki/CompilationGuide/Centos" target="_blank" rel="noopener">http://trac.ffmpeg.org/wiki/CompilationGuide/Centos</a></li><li><a href="https://gist.github.com/gboudreau/f24aed76b4cc91bfb2c1" target="_blank" rel="noopener">https://gist.github.com/gboudreau/f24aed76b4cc91bfb2c1</a></li><li><a href="http://www.videolan.org/developers/x264.html" target="_blank" rel="noopener">http://www.videolan.org/developers/x264.html</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;本文最后更新于：2015-05-25 13:12:00&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/ffmpeg-on-centos&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;在CentOS编译安装ffmpeg比较麻烦，以前也搞过多次，由于博客调整，特重新记录一下，以备不时之需。&lt;/p&gt;
    
    </summary>
    
      <category term="video" scheme="http://www.yaosansi.com/categories/video/"/>
    
    
      <category term="centos" scheme="http://www.yaosansi.com/tags/centos/"/>
    
      <category term="ffmpeg" scheme="http://www.yaosansi.com/tags/ffmpeg/"/>
    
  </entry>
  
  <entry>
    <title>Mono4.0.1与Jexus5.6在CentOS7上安装与使用</title>
    <link href="http://www.yaosansi.com/post/mono4.0.1-jexus5.6-on-centos7/"/>
    <id>http://www.yaosansi.com/post/mono4.0.1-jexus5.6-on-centos7/</id>
    <published>2015-05-21T06:00:00.000Z</published>
    <updated>2017-12-30T16:00:40.744Z</updated>
    
    <content type="html"><![CDATA[<p><code>本文最后更新于：2015-05-21 14:00:00</code><br><code>原文：http://www.yaosansi.com/post/mono4.0.1-jexus5.6-on-centos7</code></p><p>鉴于微软最近对.Net家族的大开源策略，最近有时间正好测试一下Mono4与Jexus5.6在CentOS7上安装与使用。</p><h1 id="Mono简介"><a href="#Mono简介" class="headerlink" title="Mono简介"></a>Mono简介</h1><p>Mono是一个由Novell公司(由Ximian发起，并由Miguel de lcaza<br>领导的，一个致力于开创.NET在Linux上使用的开源工程。它包含了一个C#语言的编译器，一个CLR的运行时，和一组类库，并实现了 ADO NET和ASP NET。能够使得开发人员在Linux用C#开发程序。)<br>目前最新版本为：Mono 4.0.1,由于.Net的开源，Mono4.0是首个包含来自微软开源 .Net 代码的版本，也是第一个缺省启用 Csharp 6.0 的 Mono 版本</p><p>同时还做了以下改进：</p><ul><li>采用微软的开源代码</li><li>支持 C# 6.0</li><li>优化浮点数</li><li>不再支持 2.0、3.5 和 4.0 汇编器</li><li>更新 IKVM</li><li>更轻量级的调试器开销</li><li>提供最基本的 PowerPC64 LE 支持</li></ul><p>Mono 4.0.1 只是在4.0基础上进行一些BUG修复和功能改进。<br><a id="more"></a></p><h1 id="Jexus简介"><a href="#Jexus简介" class="headerlink" title="Jexus简介"></a>Jexus简介</h1><p>Jexus 即 Jexus Web Server，简称JWS，是Linux平台上 的一款ASP.NET WEB服务器，<br>是ASP.NET跨平台部署的一种可选方案，作者<code>宇内流云</code>是想给大家提供一个强劲、坚固、免费、易用的Linux ASP.NET服务器。</p><p>与其它WEB服务器相比，Jexus不但具有跨平台ASP.NET服务器这样的标志性特征，同时还拥有内核级的安全监控、入侵检测、URL重写、无文件路由等一系列重要功能和专有特性。</p><p>目前Jexus最新版本为5.6.4正式版。</p><h1 id="安装Mono和Jexus"><a href="#安装Mono和Jexus" class="headerlink" title="安装Mono和Jexus"></a>安装Mono和Jexus</h1><p>##安装Mono</p><p>在Shell root 用户权限下输入下列命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm --import &quot;http://keyserver.ubuntu.com/pks/lookup?op=get&amp;search=0x3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF&quot;</span><br><span class="line">yum-config-manager --add-repo http://download.mono-project.com/repo/centos/</span><br></pre></td></tr></table></figure><p>如果提示找不到<code>yum-config-manager</code>博客园的张善友老师已经给出了解决方案</p><p>因为系统默认没有安装这个命令，这个命令在<code>yum-utils</code> 包里，可以通过命令<code>yum -y install yum-utils</code> 安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install yum-utils</span><br></pre></td></tr></table></figure><p>引入测试版本可以使用如下命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager --add-repo http://download.mono-project.com/repo/centos-alpha/</span><br></pre></td></tr></table></figure></p><p>安装有以下几个选择：</p><ul><li>mono-devel 安装编译版本</li><li>mono-completepv 安装所有软件包,这可以解决大多数情况下的”程序集未找到”错误。</li><li>referenceassemblies-pcl 安装支持PCL编译的版本。</li><li>ca-certificates-mono 如果需要HTTPS连接和SSL证书，请使用版本。</li></ul><p>我们安装所有软件包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum –y install mono-complete</span><br></pre></td></tr></table></figure><p>安装成功后使用mono –V 确认已经成功安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@yaosansi]# mono -V</span><br><span class="line">Mono JIT compiler version 4.0.1 (tarball Wed May 20 12:03:20 CST 2015)</span><br><span class="line">Copyright (C) 2002-2014 Novell, Inc, Xamarin Inc and Contributors. www.mono-project.com</span><br><span class="line">        TLS:           __thread</span><br><span class="line">        SIGSEGV:       altstack</span><br><span class="line">        Notifications: epoll</span><br><span class="line">        Architecture:  x86</span><br><span class="line">        Disabled:      none</span><br><span class="line">        Misc:          softdebug</span><br><span class="line">        LLVM:          supported, not enabled.</span><br><span class="line">        GC:            sgen</span><br></pre></td></tr></table></figure></p><p>如果安装一切正常，但输入 <code>mono -V</code> 时提示 <code>-bash: mono: command not found</code>, 可以使用如下命令测试:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@yaosansi ]# /opt/mono/bin/mono -V</span><br></pre></td></tr></table></figure></p><p>并参考本文中的<code>设置Mono环境变量</code>一节。</p><p>##安装Jexus</p><p>###下载</p><p>下载地址是：<code>http://www.linuxdot.net/down/jexus-5.6.4.tar.gz</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.linuxdot.net/down/jexus-5.6.4.tar.gz</span><br></pre></td></tr></table></figure><p>###解压</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jexus-5.0.tar.gz</span><br></pre></td></tr></table></figure><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd jexus-5.6.4</span><br><span class="line">./install</span><br></pre></td></tr></table></figure><h3 id="确认安装成功"><a href="#确认安装成功" class="headerlink" title="确认安装成功"></a>确认安装成功</h3><p>默认Jexus是绑定0.0.0.0的ip，所以可以通过服务器的ip来访问。(如果无法访问请确认是否由于其它程序占用了默认的80端口)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.8.2</span><br></pre></td></tr></table></figure><p>Jexus也提供了一个info地址，用来检测服务器状态和运行时间<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.8.2/info</span><br></pre></td></tr></table></figure></p><blockquote><p>Welcome to Jexus!<br>Jexus web server uptime: 0 days, 0:44:16</p></blockquote><h3 id="升级安装"><a href="#升级安装" class="headerlink" title="升级安装"></a>升级安装</h3><h3 id="启动、停止和重启"><a href="#启动、停止和重启" class="headerlink" title="启动、停止和重启"></a>启动、停止和重启</h3><p>启动 <code>/usr/jexus/jws start</code></p><p>停止 <code>/usr/jexus/jws stop</code></p><p>重启 <code>/usr/jexus/jws restart</code></p><h2 id="通过一键安装脚本"><a href="#通过一键安装脚本" class="headerlink" title="通过一键安装脚本"></a>通过一键安装脚本</h2><p><code>Jexus官方论坛网友（Simple）提供</code></p><h3 id="CentOS6版本"><a href="#CentOS6版本" class="headerlink" title="CentOS6版本"></a>CentOS6版本</h3><ul><li><p>默认版本（宇内推荐的）：<a href="http://security.ivannet.com/linux/shell/centos6.x_mono_jexus_default.sh" target="_blank" rel="noopener">http://security.ivannet.com/linux/shell/centos6.x_mono_jexus_default.sh</a></p></li><li><p>OPT版本（喜欢把mono装在/opt/目录下的）：<a href="http://security.ivannet.com/linux/shell/centos6.x_mono_jexus_opt.sh" target="_blank" rel="noopener">http://security.ivannet.com/linux/shell/centos6.x_mono_jexus_opt.sh</a></p></li></ul><h3 id="CentOS7版本"><a href="#CentOS7版本" class="headerlink" title="CentOS7版本"></a>CentOS7版本</h3><ul><li>默认版本（宇内推荐的）：<a href="http://security.ivannet.com/linux/shell/centos7.x_mono_jexus_default.sh" target="_blank" rel="noopener">http://security.ivannet.com/linux/shell/centos7.x_mono_jexus_default.sh</a></li><li></li><li>OPT版本（喜欢把mono装在/opt/目录下的）： <a href="http://security.ivannet.com/linux/shell/centos7.x_mono_jexus_opt.sh" target="_blank" rel="noopener">http://security.ivannet.com/linux/shell/centos7.x_mono_jexus_opt.sh</a></li></ul><h3 id="一键安装步骤"><a href="#一键安装步骤" class="headerlink" title="一键安装步骤"></a>一键安装步骤</h3><p>执行以下命令，输入对应的Mono及Jexus完整版本即可。脚本将正动从官方下载、编译和安装，需要耐心等待一段时间。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">wget http://security.ivannet.com/linux/shell/centos7.x_mono_jexus_default.sh</span><br><span class="line">chmod +x centos7.x_mono_jexus_default.sh</span><br><span class="line">./centos7.x_mono_jexus_default.sh</span><br></pre></td></tr></table></figure><p>比如目前Mono输入：4.0.1 Jexus输入：5.6.4 </p><p>安装完成后使用上面的方法验证是否安装成功。</p><h2 id="设置Mono环境变量"><a href="#设置Mono环境变量" class="headerlink" title="设置Mono环境变量"></a>设置Mono环境变量</h2><p>安装脚本将Mono安装到了/opt/mono/，需要将Mono的目录加入系统$PATH变量</p><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>在<code>/etc/profile</code>文件中添加变量【对所有用户生效（永久的）】 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@yaosansi ~]# vi /etc/profile</span><br></pre></td></tr></table></figure><p>在文件末尾加上如下两行代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PATH=/opt/mono/bin:$PATH</span><br><span class="line">export PATH</span><br></pre></td></tr></table></figure><p>立即生效</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@yaosansi ~]# source /etc/profile</span><br></pre></td></tr></table></figure><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>在/etc/profile.d/目录下创建一个Mono的配置<br>创建一个新的mono.sh,并在这个文件内初始化环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:/opt/mono/bin</span><br></pre></td></tr></table></figure><p>要是刚才的修改马上生效，需要执行以下代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@yaosansi profile.d]# source mono.sh</span><br></pre></td></tr></table></figure><h2 id="特别感谢"><a href="#特别感谢" class="headerlink" title="特别感谢"></a>特别感谢</h2><p>感谢宇内、张善友以及其它热心网友对.Net跨平台的突出贡献。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="http://www.mono-project.com/docs/about-mono/releases/4.0.0/" target="_blank" rel="noopener">http://www.mono-project.com/docs/about-mono/releases/4.0.0/</a></li><li><a href="http://www.mono-project.com/docs/about-mono/releases/4.0.1/" target="_blank" rel="noopener">http://www.mono-project.com/docs/about-mono/releases/4.0.1/</a></li><li><a href="http://www.jexus.org/" target="_blank" rel="noopener">http://www.jexus.org/</a></li><li><a href="http://baike.baidu.com/view/4562810.htm" target="_blank" rel="noopener">http://baike.baidu.com/view/4562810.htm</a></li><li><a href="http://www.cnblogs.com/shanyou/p/4509980.html" target="_blank" rel="noopener">http://www.cnblogs.com/shanyou/p/4509980.html</a></li><li><a href="http://www.mono-project.com/docs/getting-started/install/linux/#centos-fedora-and-derivatives" target="_blank" rel="noopener">http://www.mono-project.com/docs/getting-started/install/linux/#centos-fedora-and-derivatives</a></li><li><a href="http://www.mono-project.com/docs/getting-started/mono-basics/" target="_blank" rel="noopener">http://www.mono-project.com/docs/getting-started/mono-basics/</a></li><li><a href="http://www.linuxdot.net/bbsfile-3784" target="_blank" rel="noopener">http://www.linuxdot.net/bbsfile-3784</a></li><li><a href="http://security.ivannet.com/linux/shell/" target="_blank" rel="noopener">http://security.ivannet.com/linux/shell/</a></li><li><a href="http://www.cnblogs.com/shanyou/archive/2012/10/11/2720597.html" target="_blank" rel="noopener">http://www.cnblogs.com/shanyou/archive/2012/10/11/2720597.html</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;本文最后更新于：2015-05-21 14:00:00&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/mono4.0.1-jexus5.6-on-centos7&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;鉴于微软最近对.Net家族的大开源策略，最近有时间正好测试一下Mono4与Jexus5.6在CentOS7上安装与使用。&lt;/p&gt;
&lt;h1 id=&quot;Mono简介&quot;&gt;&lt;a href=&quot;#Mono简介&quot; class=&quot;headerlink&quot; title=&quot;Mono简介&quot;&gt;&lt;/a&gt;Mono简介&lt;/h1&gt;&lt;p&gt;Mono是一个由Novell公司(由Ximian发起，并由Miguel de lcaza&lt;br&gt;领导的，一个致力于开创.NET在Linux上使用的开源工程。它包含了一个C#语言的编译器，一个CLR的运行时，和一组类库，并实现了 ADO NET和ASP NET。能够使得开发人员在Linux用C#开发程序。)&lt;br&gt;目前最新版本为：Mono 4.0.1,由于.Net的开源，Mono4.0是首个包含来自微软开源 .Net 代码的版本，也是第一个缺省启用 Csharp 6.0 的 Mono 版本&lt;/p&gt;
&lt;p&gt;同时还做了以下改进：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;采用微软的开源代码&lt;/li&gt;
&lt;li&gt;支持 C# 6.0&lt;/li&gt;
&lt;li&gt;优化浮点数&lt;/li&gt;
&lt;li&gt;不再支持 2.0、3.5 和 4.0 汇编器&lt;/li&gt;
&lt;li&gt;更新 IKVM&lt;/li&gt;
&lt;li&gt;更轻量级的调试器开销&lt;/li&gt;
&lt;li&gt;提供最基本的 PowerPC64 LE 支持&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Mono 4.0.1 只是在4.0基础上进行一些BUG修复和功能改进。&lt;br&gt;
    
    </summary>
    
      <category term="asp.net" scheme="http://www.yaosansi.com/categories/asp-net/"/>
    
    
      <category term="centos" scheme="http://www.yaosansi.com/tags/centos/"/>
    
      <category term="iexus" scheme="http://www.yaosansi.com/tags/iexus/"/>
    
      <category term="mono" scheme="http://www.yaosansi.com/tags/mono/"/>
    
  </entry>
  
  <entry>
    <title>Redis在windows下安装与使用</title>
    <link href="http://www.yaosansi.com/post/redis-on-windows/"/>
    <id>http://www.yaosansi.com/post/redis-on-windows/</id>
    <published>2015-04-19T06:00:00.000Z</published>
    <updated>2017-12-30T16:03:33.081Z</updated>
    
    <content type="html"><![CDATA[<p><code>本文最后更新于：2015-04-19 14:00:00</code><br><code>原文：http://www.yaosansi.com/post/redis-on-windows</code></p><h1 id="Redis简介"><a href="#Redis简介" class="headerlink" title="Redis简介"></a>Redis简介</h1><p>Redis是一个开源的高级key-value（键-值）缓存与存储，以高性能著称。它也常被称为数据结构服务器，因为其中的键可以存各种数据结构包括字符串、散列、列表、集合、有序集合、位图和hyperloglog。Redis的出现，很大程度补偿了memcached这类KV数据库的不足。不仅可以用于缓存，也可以用于一些场景的存储，在很多情况下是关系数据库很好的补充。它提供了Python，Ruby，Erlang，PHP客户端，使用非常方便。</p><p>Redis最近出了3.0版本，最重要的新特性是集群（Redis Cluster），提供Redis功能子集（比如不支持多数据库）的分布式、容错的实现（最多支持1000结点）。</p><p>本想折腾一下，不过由于官方并不支持windows，目前（2015.4.10） <a href="https://github.com/MSOpenTech/redis" target="_blank" rel="noopener">https://github.com/MSOpenTech/redis</a> 的最新版本仍是 Redis 2.8。</p><a id="more"></a><h1 id="redis-windows-2-6-版本高并发时出的BUG"><a href="#redis-windows-2-6-版本高并发时出的BUG" class="headerlink" title="redis windows 2.6 版本高并发时出的BUG"></a>redis windows 2.6 版本高并发时出的BUG</h1><p>redis windows 2.6版的时候在高并发下的BUG</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lt too large (fd=11112)</span><br><span class="line">[3512] 12 Apr 11:25:53.063 # Error registering fd event for the new client: Resu</span><br><span class="line">lt too large (fd=11144)</span><br><span class="line">[3512] 12 Apr 11:25:53.095 # Error registering fd event for the new client: Resu</span><br></pre></td></tr></table></figure><p>博客园的triStoneL给出了问题的原因和相应的解决办法</p><h2 id="问题原因"><a href="#问题原因" class="headerlink" title="问题原因"></a>问题原因</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Windows版本的redis和原版的redis的实现是一样的,</span><br><span class="line">重要的是accept的返回值和aeWinAccept所返回的socket句柄逻辑不一样</span><br><span class="line">导致windows版本的redis出现了bug.在Linux中,accept的返回是递增的,</span><br><span class="line">因此linux版本的redis是可以处理eventLoop-&gt;setsize个连接的,而在windows上socket返回的句柄会以大概12的步进增长,</span><br><span class="line">所以windows版本的redis就只能处理约eventLoop-&gt;setsize/12个连接了.</span><br><span class="line"></span><br><span class="line">http://www.cnblogs.com/triStoneL/archive/2013/08/23/3277709.html</span><br></pre></td></tr></table></figure><h2 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">解决方法比较hack,我在aeEventLoop中添加一个fd_map的数组,</span><br><span class="line">用于把fd映射到0到eventLoop-&gt;setsize的值,</span><br><span class="line">这样每次从events中存取数据就通过查询fd_map来获取index,</span><br><span class="line">从而达到让redis能处理eventLoop-&gt;setsize个连接的效果.</span><br></pre></td></tr></table></figure><h1 id="redis-windows-2-8-版本配置"><a href="#redis-windows-2-8-版本配置" class="headerlink" title="redis windows 2.8 版本配置"></a>redis windows 2.8 版本配置</h1><h2 id="port"><a href="#port" class="headerlink" title="port"></a>port</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># port 6379</span><br></pre></td></tr></table></figure><p><code>port 1345</code></p><h2 id="requirepass"><a href="#requirepass" class="headerlink" title="requirepass"></a>requirepass</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requirepass foobared</span><br></pre></td></tr></table></figure><p>注意：由于redis的快速响应，即使设置密码的情况下，仍不建议在对外公开使用，因为暴力破解密码的的可能性将会更大，建议在生产环境使用内部IP和网络访问。</p><p><code>requirepass oaSsihr^VGRAnZMa5=W.UH#bWuue[sHs%tC(d@=lwF5lWJF!6^gT]Yi%@D</code></p><h2 id="maxheap-amp-heapdir"><a href="#maxheap-amp-heapdir" class="headerlink" title="maxheap &amp; heapdir"></a>maxheap &amp; heapdir</h2><p>默认的2.8版本直接运行，由于硬盘空间的原因在大部分的电脑的都会出错。</p><p><code>redis-server.exe redis.windows.conf</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">redis-2.8.19&gt;redis-server.exe</span><br><span class="line">[16752] 19 Apr 15:41:03.974 #</span><br><span class="line">The Windows version of Redis allocates a large memory mapped file for sharing</span><br><span class="line">the heap with the forked process used in persistence operations. This file</span><br><span class="line">will be created in the current working directory or the directory specified by</span><br><span class="line">the &apos;heapdir&apos; directive in the .conf file. Windows is reporting that there is</span><br><span class="line">insufficient disk space available for this file (Windows error 0x70).</span><br><span class="line"></span><br><span class="line">You may fix this problem by either reducing the size of the Redis heap with</span><br><span class="line">the --maxheap flag, or by moving the heap file to a local drive with sufficient</span><br><span class="line">space.</span><br><span class="line">Please see the documentation included with the binary distributions for more</span><br><span class="line">details on the --maxheap and --heapdir flags.</span><br><span class="line"></span><br><span class="line">Redis can not continue. Exiting.</span><br></pre></td></tr></table></figure><p>参照提示，是参数maxheap和heapdir有问题。<br>打开默认的配置文件：redis.windows.conf</p><h3 id="maxheap"><a href="#maxheap" class="headerlink" title="maxheap"></a>maxheap</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># The Linux version of Redis relies on the system call fork() to perform</span><br><span class="line"># point-in-time snapshots of the heap. In addition to the AOF and RDB backup</span><br><span class="line"># mechanism, the master-slave synchronization and clustering features are </span><br><span class="line"># dependent on this behavior of fork(). In order for the Windows version to </span><br><span class="line"># perform like the Linux version we had to simulate this aspect of fork().</span><br><span class="line"># Doing so meant moving the Redis heap into a memory mapped file that can</span><br><span class="line"># be shared with a child process. </span><br><span class="line">#</span><br><span class="line"># *** There must be disk space available for this file in order for Redis </span><br><span class="line"># to launch. *** The default configuration places this file in the local </span><br><span class="line"># appdata directory. If you wish to move this file to another local disk,</span><br><span class="line"># use the heapdir flag as described below.</span><br><span class="line">#</span><br><span class="line"># The maxheap flag controls the maximum size of this memory mapped file,</span><br><span class="line"># as well as the total usable space for the Redis heap. Running Redis</span><br><span class="line"># without either maxheap or maxmemory will result in a memory mapped file </span><br><span class="line"># being created that is equal to the size of physical memory. During </span><br><span class="line"># fork() operations the total page file commit will max out at around:</span><br><span class="line">#</span><br><span class="line">#    (size of physical memory) + (2 * size of maxheap)</span><br><span class="line">#</span><br><span class="line"># For instance, on a machine with 8GB of physical RAM, the max page file </span><br><span class="line"># commit with the default maxheap size will be (8)+(2*8) GB , or 24GB. The</span><br><span class="line"># default page file sizing of Windows will allow for this without having </span><br><span class="line"># to reconfigure the system. Larger heap sizes are possible, but the maximum</span><br><span class="line"># page file size will have to be increased accordingly.</span><br><span class="line"># </span><br><span class="line"># The Redis heap must be larger than the value specified by the maxmemory </span><br><span class="line"># flag, as the heap allocator has its own memory requirements and </span><br><span class="line"># fragmentation of the heap is inevitable. If only the maxmemory flag is </span><br><span class="line"># specified, maxheap will be set at 1.5*maxmemory. If the maxheap flag is </span><br><span class="line"># specified along with maxmemory, the maxheap flag will be automatically </span><br><span class="line"># increased if it is smaller than 1.5*maxmemory. </span><br><span class="line">#  </span><br><span class="line"># maxheap &lt;bytes&gt;</span><br></pre></td></tr></table></figure><p>我们看到，Linux版本的redis依赖于系统调用fork()来执行堆的时间快照，windows版本模拟了fork方法。maxheap标志来控制此内存映射文件的最大大小，redis在未设置 maxheap 或 maxmemory时，内存映射文件的大小等于物理内存的大小，fork()操作的总页面文件最大将是（物理内存大小）+（2<em>maxheap）<br>我们看到如果设置了maxmemory，那么maxheap=1.5</em>maxmemory，如果maxheap设置的小于1.5*maxmemory，那么maxheap的值将会自动增加。</p><p>根据以上原因，我们不难分析出，当redis所用使用的硬盘空间不足时，便会引发上面的错误。</p><p>我们设置maxheap参数为4个G，即占用硬盘空间4G.再次运行，发现一切正常。</p><p><code>maxheap 4024000000</code></p><h3 id="heapdir"><a href="#heapdir" class="headerlink" title="heapdir"></a>heapdir</h3><p>那么heapdir是做什么用的呢？</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># The heap memory mapped file must reside on a local path for heap sharing </span><br><span class="line"># between processes to work. A UNC path will not suffice here. For maximum </span><br><span class="line"># performance this should be located on the fastest local drive available.</span><br><span class="line"># This value defaults to the local application data folder(e.g.,</span><br><span class="line"># &quot;%USERPROFILE%\AppData\Local&quot;). Since this file can be very large, you</span><br><span class="line"># may wish to place this on a drive other than the one the operating system  </span><br><span class="line"># is installed on.</span><br><span class="line">#</span><br><span class="line"># Note that you must specify a directory here, not a file name.</span><br><span class="line"># heapdir &lt;directory path(absolute or relative)&gt;</span><br></pre></td></tr></table></figure><p>heapdir实际指定了内存映射文件的目录，默认在<code>%USERPROFILE%\AppData\Local</code>,大部分windows都安装在ｃ盘，而ｃ盘空间有限，结合这两个参数，我们才发现最上面的默认错误原来是我们系统硬盘可用空间不足导致的。</p><p>注意：heapdir不支持网络路径，只支持本机路径，但支持相对路径和绝对路径。</p><p>这里我们把heapdir指定在redis默认路径指定在根目录下:<code>redis_heapdir</code></p><p><code>heapdir redis_heapdir/</code></p><h2 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h2><h3 id="安装服务"><a href="#安装服务" class="headerlink" title="安装服务"></a>安装服务</h3><p><code>--service-install</code></p><p>安装服务的参数必须为redis-server的第一个参数，默认服务会使用帐户<code>NT AUTHORITY\NetworkService</code>，默认不会启动服务。</p><p>实例</p><p><code>redis-server --service-install redis.windows.conf --loglevel verbose</code></p><h3 id="卸载服务"><a href="#卸载服务" class="headerlink" title="卸载服务"></a>卸载服务</h3><p><code>--service-uninstall</code></p><p>实例</p><p><code>redis-server --service-uninstall</code></p><h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><p><code>redis-server --service-start</code></p><h3 id="停止服务"><a href="#停止服务" class="headerlink" title="停止服务"></a>停止服务</h3><p><code>redis-server --service-stop</code></p><h3 id="命名服务"><a href="#命名服务" class="headerlink" title="命名服务"></a>命名服务</h3><p><code>--service-name name</code></p><p>用来使用多实例redis服务。<br>此参数要放在service-install, service-start, service-stop or service-uninstall的后面。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">redis-server --service-install –service-name redisService1 –port 10001</span><br><span class="line">redis-server --service-start –service-name redisService1</span><br><span class="line">redis-server --service-install –service-name redisService2 –port 10002</span><br><span class="line">redis-server --service-start –service-name redisService2</span><br><span class="line">redis-server --service-install –service-name redisService3 –port 10003</span><br><span class="line">redis-server --service-start –service-name redisService3</span><br></pre></td></tr></table></figure><h2 id="客户端工具"><a href="#客户端工具" class="headerlink" title="客户端工具"></a>客户端工具</h2><ul><li>RedisStudio: <a href="https://github.com/cinience/RedisStudio" target="_blank" rel="noopener">https://github.com/cinience/RedisStudio</a></li></ul><p>##参考</p><ul><li><a href="http://redis.io" target="_blank" rel="noopener">http://redis.io</a></li><li><a href="https://github.com/MSOpenTech/redis" target="_blank" rel="noopener">https://github.com/MSOpenTech/redis</a></li><li><a href="https://github.com/ServiceStack/redis-windows" target="_blank" rel="noopener">https://github.com/ServiceStack/redis-windows</a></li><li><a href="http://stackoverflow.com/questions/28114405/how-do-i-install-a-redis-server-on-the-d-drive" target="_blank" rel="noopener">http://stackoverflow.com/questions/28114405/how-do-i-install-a-redis-server-on-the-d-drive</a></li><li><a href="http://stackoverflow.com/questions/20554362/configuring-redis-on-windows" target="_blank" rel="noopener">http://stackoverflow.com/questions/20554362/configuring-redis-on-windows</a></li><li><a href="http://blog.csdn.net/lijiecong/article/details/37754599" target="_blank" rel="noopener">http://blog.csdn.net/lijiecong/article/details/37754599</a></li><li><a href="http://blog.csdn.net/renfufei/article/details/38474435" target="_blank" rel="noopener">http://blog.csdn.net/renfufei/article/details/38474435</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;本文最后更新于：2015-04-19 14:00:00&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/redis-on-windows&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;Redis简介&quot;&gt;&lt;a href=&quot;#Redis简介&quot; class=&quot;headerlink&quot; title=&quot;Redis简介&quot;&gt;&lt;/a&gt;Redis简介&lt;/h1&gt;&lt;p&gt;Redis是一个开源的高级key-value（键-值）缓存与存储，以高性能著称。它也常被称为数据结构服务器，因为其中的键可以存各种数据结构包括字符串、散列、列表、集合、有序集合、位图和hyperloglog。Redis的出现，很大程度补偿了memcached这类KV数据库的不足。不仅可以用于缓存，也可以用于一些场景的存储，在很多情况下是关系数据库很好的补充。它提供了Python，Ruby，Erlang，PHP客户端，使用非常方便。&lt;/p&gt;
&lt;p&gt;Redis最近出了3.0版本，最重要的新特性是集群（Redis Cluster），提供Redis功能子集（比如不支持多数据库）的分布式、容错的实现（最多支持1000结点）。&lt;/p&gt;
&lt;p&gt;本想折腾一下，不过由于官方并不支持windows，目前（2015.4.10） &lt;a href=&quot;https://github.com/MSOpenTech/redis&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/MSOpenTech/redis&lt;/a&gt; 的最新版本仍是 Redis 2.8。&lt;/p&gt;
    
    </summary>
    
      <category term="cache" scheme="http://www.yaosansi.com/categories/cache/"/>
    
    
      <category term="redis" scheme="http://www.yaosansi.com/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>Memcached在windows下安装与使用</title>
    <link href="http://www.yaosansi.com/post/memcached-on-windows/"/>
    <id>http://www.yaosansi.com/post/memcached-on-windows/</id>
    <published>2014-08-03T10:24:44.000Z</published>
    <updated>2017-12-30T16:00:26.178Z</updated>
    
    <content type="html"><![CDATA[<p><code>建议：windows系统下仅为测试所有，生产环境下服务端应使用Linux系统。</code><br><code>本文最后更新于：2014-08-03 18:24</code><br><code>原文：http://www.yaosansi.com/post/memcached-on-windows</code></p><p>##Memcached介绍</p><blockquote><p>Memcached 是一个高性能的分布式内存对象缓存系统，用于动态Web应用以减轻数据库负载。它通过在内存中缓存数据和对象来减少读取数据库的次数，从而提供动态、数据库驱动网站的速度。Memcached基于一个存储键/值对的hashmap。其守护进程（daemon ）是用C写的，但是客户端可以用任何语言来编写，并通过memcached协议与守护进程通信。但是它并不提供冗余（例如，复制其hashmap条目）；当某个服务器S停止运行或崩溃了，所有存放在S上的键/值对都将丢失。</p><footer><strong>百度百科</strong><cite><a href="http://baike.baidu.com/view/794242.htm" target="_blank" rel="noopener">baike.baidu.com/view/794242.htm</a></cite></footer></blockquote><a id="more"></a><p>Memcached官方： <a href="http://memcached.org/" target="_blank" rel="noopener">http://memcached.org/</a></p><p>##Windows版本下载与安装</p><p>###下载地址<br><a href="http://s3.amazonaws.com/downloads.northscale.com/memcached-win32-1.4.4-14.zip" target="_blank" rel="noopener">memcached 1.4.4 for Windows 32-bit</a></p><p>###安装Memcache为系统服务</p><ol><li>下载memcached的windows稳定版，解压放某个盘下面，比如在<code>c:\memcached</code></li><li>在CMD下输入 “<code>c:\memcached\memcached.exe -d install</code>“ 安装.</li><li>再输入：”<code>c:\memcached\memcached.exe -d start</code>“ 启动。</li></ol><blockquote><p>NOTE:<br>也可以不安装直接启动<br>以后memcached将作为windows的一个服务每次开机时自动启动。这样服务器端已经安装完毕了。</p></blockquote><p>如果下载的是二进制的版本，直接运行就可以了，可以加上参数来加以设置。</p><p>###常用命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-p &lt;num&gt;          监听的端口</span><br><span class="line">-l &lt;ip_addr&gt;      连接的IP地址, 默认是本机</span><br><span class="line">-d start          启动memcached服务</span><br><span class="line">-d restart        重起memcached服务</span><br><span class="line">-d stop|shutdown  关闭正在运行的memcached服务</span><br><span class="line">-d install        安装memcached服务</span><br><span class="line">-d uninstall      卸载memcached服务</span><br><span class="line">-u &lt;username&gt;     以&lt;username&gt;的身份运行 (仅在以root运行的时候有效)</span><br><span class="line">-m &lt;num&gt;          最大内存使用，单位MB。默认64MB</span><br><span class="line">-M                内存耗尽时返回错误，而不是删除项</span><br><span class="line">-c &lt;num&gt;          最大同时连接数，默认是1024</span><br><span class="line">-f &lt;factor&gt;       块大小增长因子，默认是1.25</span><br><span class="line">-n &lt;bytes&gt;        最小分配空间，key+value+flags默认是48</span><br><span class="line">-h                显示帮助</span><br></pre></td></tr></table></figure></p><p>然后就可以用.net 的memcached客户端来试一下了。</p><p>##客户端使用</p><p>###C#下可用的library</p><blockquote><p>每个客户端API中都有详细的说明和注释</p></blockquote><ul><li><strong>.NET memcached client library</strong> <a href="https://sourceforge.net/projects/memcacheddotnet/" target="_blank" rel="noopener">https://sourceforge.net/projects/memcacheddotnet/</a></li><li><strong>EnyimMemcached</strong> <a href="http://www.codeplex.com/EnyimMemcached/" target="_blank" rel="noopener">http://www.codeplex.com/EnyimMemcached/</a> - Client developed in .NET 2.0 keeping performance and extensibility inmind. (Supports consistent hashing.) </li><li><strong>beitmemcached</strong> h.NET memcached client library <a href="http://code.google.com/p/beitmemcached/" target="_blank" rel="noopener">http://code.google.com/p/beitmemcached/</a> - Client developed by BeIT with many new features</li></ul><blockquote><p>博客园使用的组合为： <code>couchbase+EnyimMemcached</code>  <a href="http://www.couchbase.com/" target="_blank" rel="noopener">http://www.couchbase.com/</a></p></blockquote><p>###一致性hash算法</p><ul><li><a href="http://blog.csdn.net/kongqz/article/details/6695417" target="_blank" rel="noopener">memcache的一致性hash算法使用</a></li></ul><figure class="highlight csharp"><figcaption><span>.NET实现（注释参考JAVA版本）</span><a href="http://www.cnblogs.com/daizhj/archive/2010/08/24/1807324.html" target="_blank" rel="noopener">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">KetamaNodeLocator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//原文中的JAVA类TreeMap实现了Comparator方法，这里我图省事，直接用了net下的SortedList，其中Comparer接口方法）</span></span><br><span class="line">    <span class="keyword">private</span> SortedList&lt;<span class="keyword">long</span>, <span class="keyword">string</span>&gt; ketamaNodes = <span class="keyword">new</span> SortedList&lt;<span class="keyword">long</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line">    <span class="keyword">private</span> HashAlgorithm hashAlg;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> numReps = <span class="number">160</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//此处参数与JAVA版中有区别，因为使用的静态方法，所以不再传递HashAlgorithm alg参数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">KetamaNodeLocator</span>(<span class="params">List&lt;<span class="keyword">string</span>&gt; nodes, <span class="keyword">int</span> nodeCopies</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ketamaNodes = <span class="keyword">new</span> SortedList&lt;<span class="keyword">long</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line">        numReps = nodeCopies;</span><br><span class="line">        <span class="comment">//对所有节点，生成nCopies个虚拟结点</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">string</span> node <span class="keyword">in</span> nodes)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//每四个虚拟结点为一组</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numReps / <span class="number">4</span>; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//getKeyForNode方法为这组虚拟结点得到惟一名称 </span></span><br><span class="line">                <span class="keyword">byte</span>[] digest = HashAlgorithm.computeMd5(node + i);</span><br><span class="line">                <span class="comment">/** Md5是一个16字节长度的数组，将16字节的数组每四个字节一组，分别对应一个虚拟结点，这就是为什么上面把虚拟结点四个划分一组的原因*/</span>  </span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; <span class="number">4</span>; h++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">long</span> m = HashAlgorithm.hash(digest, h);</span><br><span class="line">                    ketamaNodes[m] = node;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">GetPrimary</span>(<span class="params"><span class="keyword">string</span> k</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span>[] digest = HashAlgorithm.computeMd5(k);</span><br><span class="line">        <span class="keyword">string</span> rv = GetNodeForKey(HashAlgorithm.hash(digest, <span class="number">0</span>));</span><br><span class="line">        <span class="keyword">return</span> rv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">string</span> <span class="title">GetNodeForKey</span>(<span class="params"><span class="keyword">long</span> hash</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">string</span> rv;</span><br><span class="line">        <span class="keyword">long</span> key = hash;</span><br><span class="line">        <span class="comment">//如果找到这个节点，直接取节点，返回   </span></span><br><span class="line">        <span class="keyword">if</span> (!ketamaNodes.ContainsKey(key))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//得到大于当前key的那个子Map，然后从中取出第一个key，就是大于且离它最近的那个key 说明详见: http://www.javaeye.com/topic/684087</span></span><br><span class="line">            <span class="keyword">var</span> tailMap = <span class="keyword">from</span> coll <span class="keyword">in</span> ketamaNodes</span><br><span class="line">                          <span class="keyword">where</span> coll.Key &gt; hash</span><br><span class="line">                          <span class="keyword">select</span> <span class="keyword">new</span> &#123; coll.Key &#125;;</span><br><span class="line">            <span class="keyword">if</span> (tailMap == <span class="literal">null</span> || tailMap.Count() == <span class="number">0</span>)</span><br><span class="line">                key = ketamaNodes.FirstOrDefault().Key;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                key = tailMap.FirstOrDefault().Key;</span><br><span class="line">        &#125;</span><br><span class="line">        rv = ketamaNodes[key];</span><br><span class="line">        <span class="keyword">return</span> rv;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面的代码与JAVA中有所不同，它使用静态方法实现</p><figure class="highlight csharp"><figcaption><span>静态方法实现</span><a href="http://www.cnblogs.com/daizhj/archive/2010/08/24/1807324.html" target="_blank" rel="noopener">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HashAlgorithm</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">hash</span>(<span class="params"><span class="keyword">byte</span>[] digest, <span class="keyword">int</span> nTime</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> rv = ((<span class="keyword">long</span>)(digest[<span class="number">3</span> + nTime * <span class="number">4</span>] &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">24</span>)</span><br><span class="line">                | ((<span class="keyword">long</span>)(digest[<span class="number">2</span> + nTime * <span class="number">4</span>] &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">16</span>)</span><br><span class="line">                | ((<span class="keyword">long</span>)(digest[<span class="number">1</span> + nTime * <span class="number">4</span>] &amp; <span class="number">0xFF</span>) &lt;&lt; <span class="number">8</span>)</span><br><span class="line">                | ((<span class="keyword">long</span>)digest[<span class="number">0</span> + nTime * <span class="number">4</span>] &amp; <span class="number">0xFF</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> rv &amp; <span class="number">0xffffffff</span>L; <span class="comment">/* Truncate to 32-bits */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the md5 of the given key.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] <span class="title">computeMd5</span>(<span class="params"><span class="keyword">string</span> k</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        MD5 md5 = <span class="keyword">new</span> MD5CryptoServiceProvider();</span><br><span class="line">       </span><br><span class="line">        <span class="keyword">byte</span>[] keyBytes = md5.ComputeHash(Encoding.UTF8.GetBytes(k));</span><br><span class="line">        md5.Clear();</span><br><span class="line">        <span class="comment">//md5.update(keyBytes);</span></span><br><span class="line">        <span class="comment">//return md5.digest();</span></span><br><span class="line">        <span class="keyword">return</span> keyBytes;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>##Linux系统安装memcached</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://memcached.org/latest</span><br><span class="line">tar -zxvf memcached-1.x.x.tar.gz</span><br><span class="line"><span class="built_in">cd</span> memcached-1.x.x</span><br><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/memcached</span><br><span class="line">make &amp;&amp; make <span class="built_in">test</span></span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><h3 id="Ubuntu-amp-Debian"><a href="#Ubuntu-amp-Debian" class="headerlink" title="Ubuntu &amp; Debian"></a>Ubuntu &amp; Debian</h3><p><code>apt-get install memcached</code></p><h3 id="Redhat-Fedora"><a href="#Redhat-Fedora" class="headerlink" title="Redhat/Fedora"></a>Redhat/Fedora</h3><p><code>yum install memcached</code></p><h3 id="FreeBSD"><a href="#FreeBSD" class="headerlink" title="FreeBSD"></a>FreeBSD</h3><p><code>portmaster databases/memcached</code></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li>memcached官方 <a href="http://www.memcached.org/" target="_blank" rel="noopener">http://www.memcached.org/</a></li><li><a href="https://code.google.com/p/memcached/" target="_blank" rel="noopener">https://code.google.com/p/memcached/</a></li><li><a href="http://www.cnblogs.com/luluping/archive/2009/01/14/1375456.html" target="_blank" rel="noopener">Memcached深度分析</a></li><li>一致性Hash算法(KetamaHash)的c#实现 <a href="http://www.cnblogs.com/daizhj/archive/2010/08/24/1807324.html" target="_blank" rel="noopener">http://www.cnblogs.com/daizhj/archive/2010/08/24/1807324.html</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;建议：windows系统下仅为测试所有，生产环境下服务端应使用Linux系统。&lt;/code&gt;&lt;br&gt;&lt;code&gt;本文最后更新于：2014-08-03 18:24&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/memcached-on-windows&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;##Memcached介绍&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Memcached 是一个高性能的分布式内存对象缓存系统，用于动态Web应用以减轻数据库负载。它通过在内存中缓存数据和对象来减少读取数据库的次数，从而提供动态、数据库驱动网站的速度。Memcached基于一个存储键/值对的hashmap。其守护进程（daemon ）是用C写的，但是客户端可以用任何语言来编写，并通过memcached协议与守护进程通信。但是它并不提供冗余（例如，复制其hashmap条目）；当某个服务器S停止运行或崩溃了，所有存放在S上的键/值对都将丢失。&lt;/p&gt;
&lt;footer&gt;&lt;strong&gt;百度百科&lt;/strong&gt;&lt;cite&gt;&lt;a href=&quot;http://baike.baidu.com/view/794242.htm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;baike.baidu.com/view/794242.htm&lt;/a&gt;&lt;/cite&gt;&lt;/footer&gt;&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="windows" scheme="http://www.yaosansi.com/tags/windows/"/>
    
      <category term="memcached" scheme="http://www.yaosansi.com/tags/memcached/"/>
    
  </entry>
  
  <entry>
    <title>GitHub上Markdown基本使用</title>
    <link href="http://www.yaosansi.com/post/markdown-on-github/"/>
    <id>http://www.yaosansi.com/post/markdown-on-github/</id>
    <published>2014-08-01T04:44:50.000Z</published>
    <updated>2017-12-30T16:00:13.463Z</updated>
    
    <content type="html"><![CDATA[<p><code>本文最后更新于：2014-08-01 12:44:50</code><br><code>原文：http://www.yaosansi.com/post/markdown-on-github/</code></p><h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ol><li><a href="http://www.yaosansi.com/post/markdown-on-github/#1-_基本写作">基本写作</a><br>1.1 <a href="http://www.yaosansi.com/post/markdown-on-github/#1-1_段落">段落</a><br>1.2 <a href="http://www.yaosansi.com/post/markdown-on-github/#1-2_标题">标题</a><br>1.3 <a href="http://www.yaosansi.com/post/markdown-on-github/#1-3_引用">引用</a><br>1.4 <a href="http://www.yaosansi.com/post/markdown-on-github/#1-4_粗体和斜体">粗体和斜体</a><br>1.5 <a href="http://www.yaosansi.com/post/markdown-on-github/#1-5_删除线">删除线</a></li><li><a href="http://www.yaosansi.com/post/markdown-on-github/#2-_列表">列表</a><br>2.1 <a href="http://www.yaosansi.com/post/markdown-on-github/#2-1_无序列表">无序列表</a><br>2.1 <a href="http://www.yaosansi.com/post/markdown-on-github/#2-2_有序列表">有序列表</a><br>2.3 <a href="http://www.yaosansi.com/post/markdown-on-github/#2-3_嵌套列表">嵌套列表</a></li><li><a href="http://www.yaosansi.com/post/markdown-on-github/#3-_代码格式化">代码格式化</a><br>3.1 <a href="http://www.yaosansi.com/post/markdown-on-github/#3-1_单行格式化">单行格式化</a><br>3.2 <a href="http://www.yaosansi.com/post/markdown-on-github/#3-_2单行格式化">多行格式化</a></li><li><a href="http://www.yaosansi.com/post/markdown-on-github/#4-_链接和图片">链接和图片</a><br>4.1 <a href="http://www.yaosansi.com/post/markdown-on-github/#4-_链接">链接</a><br>4.2 <a href="http://www.yaosansi.com/post/markdown-on-github/#4-_图片">图片</a></li><li><a href="http://www.yaosansi.com/post/markdown-on-github/#5-_GitHub扩展语法">GitHub扩展语法</a><br>5.1 <a href="http://www.yaosansi.com/post/markdown-on-github/#5-1_语法高亮">语法高亮</a><br>5.2 <a href="http://www.yaosansi.com/post/markdown-on-github/#5-2_任务列表">任务列表</a><br>5.3 <a href="http://www.yaosansi.com/post/markdown-on-github/#5-3_表格">表格</a></li><li><a href="http://www.yaosansi.com/post/markdown-on-github/#6-_其它">其它</a><br>6.1 <a href="http://www.yaosansi.com/post/markdown-on-github/#6-1_转义字符">转义字符</a></li></ol><a id="more"></a><p>[TOC]</p><!--- This is very useful for collecting feedback in a collaborative document. --><h1 id="Markdown基础"><a href="#Markdown基础" class="headerlink" title="Markdown基础"></a>Markdown基础</h1><h2 id="1-基本写作"><a href="#1-基本写作" class="headerlink" title="1. 基本写作"></a>1. 基本写作</h2><h3 id="1-1-段落"><a href="#1-1-段落" class="headerlink" title="1.1 段落"></a>1.1 段落</h3><p>段落在Markdown中由一行或多行的空白行组成.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这是段落一. 这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.</span><br><span class="line"></span><br><span class="line">这是段落二.这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二.</span><br></pre></td></tr></table></figure><p>这是段落一. 这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.这是段落一.</p><p>这是段落二.这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. 这是段落二. </p><h3 id="1-2-标题"><a href="#1-2-标题" class="headerlink" title="1.2 标题"></a>1.2 标题</h3><p>在标题文字前面加一个或多个#符号,此行文字即为一行标题.#符号的数量决定标题的大小.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 这是标题一 (&lt;h1&gt;)</span><br><span class="line">## 这是标题二 (&lt;h2&gt;)</span><br><span class="line">...</span><br><span class="line">###### 这是标题六(&lt;h6&gt;)</span><br></pre></td></tr></table></figure><h1 id="这是标题一"><a href="#这是标题一" class="headerlink" title="这是标题一"></a>这是标题一</h1><h2 id="这是标题二"><a href="#这是标题二" class="headerlink" title="这是标题二"></a>这是标题二</h2><p>…</p><h6 id="这是标题六"><a href="#这是标题六" class="headerlink" title="这是标题六"></a>这是标题六</h6><h3 id="1-3-引用"><a href="#1-3-引用" class="headerlink" title="1.3 引用"></a>1.3 引用</h3><p>引用以&gt;符号开始<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">下面就是引用</span><br><span class="line">&gt; 这里是引用</span><br></pre></td></tr></table></figure></p><p>下面就是引用</p><blockquote><p>这里是引用</p></blockquote><h3 id="1-4-粗体和斜体"><a href="#1-4-粗体和斜体" class="headerlink" title="1.4 粗体和斜体"></a>1.4 粗体和斜体</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*这是斜体*</span><br><span class="line">**这是粗体**</span><br></pre></td></tr></table></figure><p><em>这是斜体</em><br><strong>这是粗体</strong></p><blockquote><p>也可使用下划线(<code>_</code>)代替(<code>*</code>)号</p></blockquote><h3 id="1-5-删除线"><a href="#1-5-删除线" class="headerlink" title="1.5 删除线"></a>1.5 删除线</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~~这是删除线~~</span><br></pre></td></tr></table></figure><p><del>这是删除线</del></p><h2 id="2-列表"><a href="#2-列表" class="headerlink" title="2. 列表"></a>2. 列表</h2><h3 id="2-1-无序列表"><a href="#2-1-无序列表" class="headerlink" title="2.1 无序列表"></a>2.1 无序列表</h3><p>可以在每个列表项前加星号(<code>*</code>)或横线(<code>-</code>)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 项目一</span><br><span class="line">* 项目二</span><br><span class="line">* 项目三</span><br><span class="line"></span><br><span class="line">- 项目一</span><br><span class="line">- 项目二</span><br><span class="line">- 项目三</span><br></pre></td></tr></table></figure><ul><li>项目一</li><li>项目二</li><li>项目三</li></ul><ul><li>项目一</li><li>项目二</li><li>项目三</li></ul><h3 id="2-2-有序列表"><a href="#2-2-有序列表" class="headerlink" title="2.2 有序列表"></a>2.2 有序列表</h3><p>在每个项目前增加数字和句点(<code>英文</code>)即可.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 项目一</span><br><span class="line">2. 项目二</span><br><span class="line">3. 项目三</span><br></pre></td></tr></table></figure></p><ol><li>项目一</li><li>项目二</li><li>项目三</li></ol><h3 id="2-3-嵌套列表"><a href="#2-3-嵌套列表" class="headerlink" title="2.3 嵌套列表"></a>2.3 嵌套列表</h3><p>在每个项目前增加两个空格缩进<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1. 项目一</span><br><span class="line">  1. 嵌套有序列表项目一</span><br><span class="line">  2. 嵌套有序列表项目二</span><br><span class="line">    - 嵌套无序列表项目一</span><br><span class="line">    - 嵌套无序列表项目二</span><br><span class="line">    - 嵌套无序列表项目三</span><br><span class="line">      1. 多级嵌套有序列表项目一</span><br><span class="line">      2. 多级嵌套有序列表项目二</span><br><span class="line">        - 嵌套无序列表项目一</span><br><span class="line">        - 嵌套无序列表项目二</span><br><span class="line">        - 嵌套无序列表项目三</span><br><span class="line">2. 项目二</span><br><span class="line">3. 项目三</span><br></pre></td></tr></table></figure></p><ol><li>项目一<ol><li>嵌套有序列表项目一</li><li>嵌套有序列表项目二<ul><li>嵌套无序列表项目一</li><li>嵌套无序列表项目二</li><li>嵌套无序列表项目三</li></ul><ol><li>多级嵌套有序列表项目一</li><li>多级嵌套有序列表项目二<ul><li>嵌套无序列表项目一</li><li>嵌套无序列表项目二</li><li>嵌套无序列表项目三</li></ul></li></ol></li></ol></li><li>项目二</li><li>项目三</li></ol><h2 id="3-代码格式化"><a href="#3-代码格式化" class="headerlink" title="3. 代码格式化"></a>3. 代码格式化</h2><h3 id="3-1-单行格式化"><a href="#3-1-单行格式化" class="headerlink" title="3.1 单行格式化"></a>3.1 单行格式化</h3><p>使用反引号（```）作为单行代码的引用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Here&apos;s an idea: why don&apos;t we take `SuperiorProject` and turn it into `**Reasonable**Project`.</span><br></pre></td></tr></table></figure><p>Here’s an idea: why don’t we take <code>SuperiorProject</code> and turn it into <code>**Reasonable**Project</code>.</p><h3 id="3-2-多行格式化"><a href="#3-2-多行格式化" class="headerlink" title="3.2 多行格式化"></a>3.2 多行格式化</h3><p>使用三个反引号（```）作为多行代码的引用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Check out this neat program I wrote:</span><br><span class="line">` ` `</span><br><span class="line">x = 0</span><br><span class="line">x = 2 + 2</span><br><span class="line">what is x</span><br><span class="line">` ` `</span><br></pre></td></tr></table></figure><p>Check out this neat program I wrote:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = 0</span><br><span class="line">x = 2 + 2</span><br><span class="line">what is x</span><br></pre></td></tr></table></figure><h2 id="4-链接和图片"><a href="#4-链接和图片" class="headerlink" title="4. 链接和图片"></a>4. 链接和图片</h2><p>###　4.1　链接<br>链接的格式如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1 http://www.yaosansi.com/   (自动生成链接)</span><br><span class="line">2 [这是链接内容](http://www.yaosansi.com/这是链接地址)</span><br><span class="line">3 [这是链接内容](http://www.yaosansi.com/这是链接地址 &quot;这里是链接说明&quot;)</span><br><span class="line">4 [这是链接内容][1]</span><br><span class="line"></span><br><span class="line">文档任意位置(通常是尾部)</span><br><span class="line">[1]:http://www.yaosansi.com/这是链接地址 &quot;这里是链接说明&quot;</span><br></pre></td></tr></table></figure></p><p>1 <a href="http://www.yaosansi.com/">http://www.yaosansi.com/</a>   (自动生成链接)<br>2 <a href="http://www.yaosansi.com/这是链接地址">这是链接内容</a><br>3 <a href="http://www.yaosansi.com/这是链接地址" title="这里是链接说明">这是链接内容</a><br>4 <a href="http://www.yaosansi.com/这是链接地址" title="这里是链接说明">这是链接内容</a></p><h3 id="4-2-图片"><a href="#4-2-图片" class="headerlink" title="4.2 图片"></a>4.2 图片</h3><p>图片格式如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![提示文字](图片地址)</span><br></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://www.baidu.com/img/baidu_sylogo1.gif" alt="提示文字" title="">                </div>                <div class="image-caption">提示文字</div>            </figure><h2 id="5-GitHub扩展语法"><a href="#5-GitHub扩展语法" class="headerlink" title="5. GitHub扩展语法"></a>5. GitHub扩展语法</h2><h3 id="5-1-语法高亮"><a href="#5-1-语法高亮" class="headerlink" title="5.1 语法高亮"></a>5.1 语法高亮</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">` ` `javascript</span><br><span class="line">function fancyAlert(arg) &#123;</span><br><span class="line">  if(arg) &#123;</span><br><span class="line">    $.facebox(&#123;div:&apos;#foo&apos;&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">` ` `</span><br></pre></td></tr></table></figure><h3 id="5-2-任务列表"><a href="#5-2-任务列表" class="headerlink" title="5.2 任务列表"></a>5.2 任务列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- [x] 已完成任务一</span><br><span class="line">- [x] 已完成任务二</span><br><span class="line">- [x] 已完成任务三</span><br><span class="line">- [ ] 未完成任务四</span><br><span class="line">- [ ] 未完成任务五</span><br></pre></td></tr></table></figure><ul><li style="list-style: none"><input type="checkbox" checked> 已完成任务一</li><li style="list-style: none"><input type="checkbox" checked> 已完成任务二</li><li style="list-style: none"><input type="checkbox" checked> 已完成任务三</li><li style="list-style: none"><input type="checkbox"> 未完成任务四</li><li style="list-style: none"><input type="checkbox"> 未完成任务五</li></ul><h3 id="5-3-表格"><a href="#5-3-表格" class="headerlink" title="5.3 表格"></a>5.3 表格</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第一表头 | 第二表头</span><br><span class="line">------------ | -------------</span><br><span class="line">第一单元格内容 | 第二单元格内容</span><br><span class="line">第一列内容 | 第二列内容</span><br></pre></td></tr></table></figure><table><thead><tr><th>第一表头</th><th>第二表头</th></tr></thead><tbody><tr><td>第一单元格内容</td><td>第二单元格内容</td></tr><tr><td>第一列内容</td><td>第二列内容</td></tr></tbody></table><h3 id="5-4-Emoji表情"><a href="#5-4-Emoji表情" class="headerlink" title="5.4 Emoji表情"></a>5.4 Emoji表情</h3><p>GitHub支持Emoji :  smile: :  running:<br>更多表情参考:<a href="http://www.emoji-cheat-sheet.com/" target="_blank" rel="noopener">http://www.emoji-cheat-sheet.com/</a></p><h2 id="6-其它"><a href="#6-其它" class="headerlink" title="6. 其它"></a>6. 其它</h2><h3 id="6-1-转义字符"><a href="#6-1-转义字符" class="headerlink" title="6.1 转义字符"></a>6.1 转义字符</h3><p>可以用反斜杠来插入一些在语法中有其它意义的符号，如：可以在星号的前面加上反斜杠<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\*literal asterisks\*</span><br></pre></td></tr></table></figure></p><p>*literal asterisks*</p><p>反斜杠支持下面的字符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">\   反斜杠</span><br><span class="line">`   反引号</span><br><span class="line">*   星号</span><br><span class="line">_   底线</span><br><span class="line">&#123;&#125;  大括号</span><br><span class="line">[]  方括号</span><br><span class="line">()  括号</span><br><span class="line">#   井字号</span><br><span class="line">+    加号</span><br><span class="line">-    减号</span><br><span class="line">.   英文句点</span><br><span class="line">!   惊叹号</span><br></pre></td></tr></table></figure></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li>Markdown Basics <a href="https://help.github.com/articles/markdown-basics" target="_blank" rel="noopener">https://help.github.com/articles/markdown-basics</a></li><li>Mastering Markdown <a href="https://guides.github.com/features/mastering-markdown/" target="_blank" rel="noopener">https://guides.github.com/features/mastering-markdown/</a></li><li>GitHub Flavored Markdown <a href="https://help.github.com/articles/github-flavored-markdown" target="_blank" rel="noopener">https://help.github.com/articles/github-flavored-markdown</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;本文最后更新于：2014-08-01 12:44:50&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/markdown-on-github/&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;目录&quot;&gt;&lt;a href=&quot;#目录&quot; class=&quot;headerlink&quot; title=&quot;目录&quot;&gt;&lt;/a&gt;目录&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#1-_基本写作&quot;&gt;基本写作&lt;/a&gt;&lt;br&gt;1.1 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#1-1_段落&quot;&gt;段落&lt;/a&gt;&lt;br&gt;1.2 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#1-2_标题&quot;&gt;标题&lt;/a&gt;&lt;br&gt;1.3 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#1-3_引用&quot;&gt;引用&lt;/a&gt;&lt;br&gt;1.4 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#1-4_粗体和斜体&quot;&gt;粗体和斜体&lt;/a&gt;&lt;br&gt;1.5 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#1-5_删除线&quot;&gt;删除线&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#2-_列表&quot;&gt;列表&lt;/a&gt;&lt;br&gt;2.1 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#2-1_无序列表&quot;&gt;无序列表&lt;/a&gt;&lt;br&gt;2.1 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#2-2_有序列表&quot;&gt;有序列表&lt;/a&gt;&lt;br&gt;2.3 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#2-3_嵌套列表&quot;&gt;嵌套列表&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#3-_代码格式化&quot;&gt;代码格式化&lt;/a&gt;&lt;br&gt;3.1 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#3-1_单行格式化&quot;&gt;单行格式化&lt;/a&gt;&lt;br&gt;3.2 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#3-_2单行格式化&quot;&gt;多行格式化&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#4-_链接和图片&quot;&gt;链接和图片&lt;/a&gt;&lt;br&gt;4.1 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#4-_链接&quot;&gt;链接&lt;/a&gt;&lt;br&gt;4.2 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#4-_图片&quot;&gt;图片&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#5-_GitHub扩展语法&quot;&gt;GitHub扩展语法&lt;/a&gt;&lt;br&gt;5.1 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#5-1_语法高亮&quot;&gt;语法高亮&lt;/a&gt;&lt;br&gt;5.2 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#5-2_任务列表&quot;&gt;任务列表&lt;/a&gt;&lt;br&gt;5.3 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#5-3_表格&quot;&gt;表格&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#6-_其它&quot;&gt;其它&lt;/a&gt;&lt;br&gt;6.1 &lt;a href=&quot;http://www.yaosansi.com/post/markdown-on-github/#6-1_转义字符&quot;&gt;转义字符&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="web" scheme="http://www.yaosansi.com/categories/web/"/>
    
    
      <category term="github" scheme="http://www.yaosansi.com/tags/github/"/>
    
      <category term="markdown" scheme="http://www.yaosansi.com/tags/markdown/"/>
    
  </entry>
  
  <entry>
    <title>更换ip后，IIS无法正常启动</title>
    <link href="http://www.yaosansi.com/post/iis-fails-to-start-after-change-ip/"/>
    <id>http://www.yaosansi.com/post/iis-fails-to-start-after-change-ip/</id>
    <published>2014-07-24T05:44:08.000Z</published>
    <updated>2017-12-30T15:59:22.192Z</updated>
    
    <content type="html"><![CDATA[<p><code>本文最后更新于：2014-07-24 13:44:08</code><br><code>原文：http://www.yaosansi.com/post/iis-fails-to-start-after-change-ip/</code></p><p>##概述<br>今天更换IP后出现无法正常访问,经过近1小时的折腾终于解决了,现记录如下:</p><p>##系统环境</p><ul><li><strong>操作系统:</strong> Win2008</li><li><strong>网络:</strong> 同一网卡绑定两个IP  <code>192.168.0.1</code>  <code>192.168.0.2</code></li><li><strong>原WEB服务器:</strong> IIS(<code>192.168.0.1</code>) Tomcat(<code>192.168.0.2</code>)</li><li><strong>更换IP后:</strong> IIS(<code>192.168.1.1</code>) Tomcat(<code>192.168.0.2</code>)</li></ul><blockquote><p>两服务器都使用80端口,使用不同的IP绑定不同的域名  </p></blockquote><a id="more"></a><blockquote><p>PS.不要问为什么不用NGINX等做做反向代理</p></blockquote><h2 id="问题一"><a href="#问题一" class="headerlink" title="##问题一"></a>##问题一</h2><p>###现象</p><ul><li>IIS无任何提示,本机无法开启80端口</li></ul><p>###解决方法<br>怀疑是两个WEB Server相互冲突,重启系统</p><h2 id="问题二"><a href="#问题二" class="headerlink" title="##问题二"></a>##问题二</h2><p>###现象</p><ul><li>指定的网络名格式无效</li><li>万维网发布服务(WWW 服务)没有为站点 2 注册 URL 前缀 <a href="http://www.yaoasnsi.com:80:192.168.1.1/" target="_blank" rel="noopener">http://www.yaoasnsi.com:80:192.168.1.1/</a>  。 该站点已被禁用。数据字段包含错误号。<blockquote><p>其中192.168.1.1为我们更换后的要绑定的IP</p></blockquote></li></ul><p>###解决方法<br>GOOGLE发现此文件 指定的<a href="http://www.cnblogs.com/hsapphire/archive/2010/03/26/1696681.html" target="_blank" rel="noopener">网络名格式无效</a> ,按此操作后,重启服务器</p><blockquote><p>WIN2003， 换了个IP以后， IIS 里面的站点就无法启动了， 一启动就出现 “指定的网络名格式无效”， 怎么解决？？</p><p>这与以前系统绑定ＩＰ有关.只要把以前的ＩＩＳ配置文件中与绑定有关的数据修改回来就可以用了 </p><ul><li>绑定到某IP： httpcfg set iplisten -i 192.168.1.1 </li><li>即命令使用IIS的只监听指定的IP及端口 </li><li>查看绑定： httpcfg query iplisten </li><li>删除绑定： httpcfg delete iplisten -i 192.168.1.1 </li></ul></blockquote><p>为解决这上面的问题，只要你把以前的绑定的ＩＰ删除，然后，再绑定0.0.0.0以后.重启服务器.在ＩＩＳ中选全部未分配ＩＰ就可以使用了. </p><ul><li>查看绑定：       httpcfg query iplisten </li></ul><blockquote><p>显示 192.168.0.1 </p></blockquote><ul><li>删除绑定：       httpcfg delete iplisten -i 192.168.0.1 </li><li>绑定0.0.0.0：    httpcfg set iplisten -i 0.0.0.0</li><li>重启IIS：        IISReset</li></ul><p>httpcfg  在windows 2003光盘上有.<a href="http://support.microsoft.com/kb/813368/" target="_blank" rel="noopener">http://support.microsoft.com/kb/813368/</a> </p><h2 id="问题三"><a href="#问题三" class="headerlink" title="##问题三"></a>##问题三</h2><p>###现象</p><ul><li>返回404 http not found</li></ul><blockquote><p>按问题二解决以后,发现IIS可以正常访问,但Tomcat不能访问了.</p></blockquote><p>###解决方法<br>按问题二解决方法,将最后一步的 绑定<code>0.0.0.0</code>  改成 绑定<code>192.168.1.1</code>  ,重启服务器.</p><h2 id="问题四"><a href="#问题四" class="headerlink" title="##问题四"></a>##问题四</h2><p>###现象</p><ul><li>另一个程序正在使用此文件，进程无法访问</li></ul><p>###解决方法<br>此问题因其它程序占用80端口导致IIS无法使用,确定无其它程序占用后怀疑是两个WEB Server相互冲突,重启系统即正常了.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;本文最后更新于：2014-07-24 13:44:08&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/iis-fails-to-start-after-change-ip/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;##概述&lt;br&gt;今天更换IP后出现无法正常访问,经过近1小时的折腾终于解决了,现记录如下:&lt;/p&gt;
&lt;p&gt;##系统环境&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;操作系统:&lt;/strong&gt; Win2008&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;网络:&lt;/strong&gt; 同一网卡绑定两个IP  &lt;code&gt;192.168.0.1&lt;/code&gt;  &lt;code&gt;192.168.0.2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;原WEB服务器:&lt;/strong&gt; IIS(&lt;code&gt;192.168.0.1&lt;/code&gt;) Tomcat(&lt;code&gt;192.168.0.2&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;更换IP后:&lt;/strong&gt; IIS(&lt;code&gt;192.168.1.1&lt;/code&gt;) Tomcat(&lt;code&gt;192.168.0.2&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;两服务器都使用80端口,使用不同的IP绑定不同的域名  &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="web" scheme="http://www.yaosansi.com/categories/web/"/>
    
    
      <category term="iis" scheme="http://www.yaosansi.com/tags/iis/"/>
    
  </entry>
  
  <entry>
    <title>如何将Emmet安装到到 Sublime text 3？</title>
    <link href="http://www.yaosansi.com/post/install-emmet-for-sublime-text-3/"/>
    <id>http://www.yaosansi.com/post/install-emmet-for-sublime-text-3/</id>
    <published>2014-06-04T06:36:03.000Z</published>
    <updated>2017-12-30T16:00:00.078Z</updated>
    
    <content type="html"><![CDATA[<p><code>本文最后更新于：2014-06-4 14:36:03</code><br><code>原文：http://www.yaosansi.com/post/install-emmet-for-sublime-text-3/</code></p><p>这是Sublime text 3与2版本的安装是有区别的，下面的方法是我感觉比较简单的，其他的要命令什么的感觉太复杂了，经测试是OK的。</p><a id="more"></a><p>##一、安装Package Control</p><p>1、通过快捷键 ctrl+` 或者 View &gt; Show Console 菜单打开控制台</p><p>2、粘贴对应版本的代码后回车安装</p><p><strong>适用于 Sublime Text 3</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import  urllib.request,os;pf=<span class="string">'Package Control.sublime-package'</span>;ipp=sublime.installed_packages_path();urllib.request.install_opener(urllib.request.build_opener(urllib.request.ProxyHandler()));open(os.path.join(ipp,pf),<span class="string">'wb'</span>).write(urllib.request.urlopen(<span class="string">'http://sublime.wbond.net/'</span>+pf.replace(<span class="string">' '</span>,<span class="string">'%20'</span>)).<span class="built_in">read</span>())</span><br></pre></td></tr></table></figure><p><strong>适用于 Sublime Text 2：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import  urllib2,os;pf=<span class="string">'Package Control.sublime-package'</span>;ipp=sublime.installed_packages_path();os.makedirs(ipp)ifnotos.path.exists(ipp)elseNone;urllib2.install_opener(urllib2.build_opener(urllib2.ProxyHandler()));open(os.path.join(ipp,pf),<span class="string">'wb'</span>).write(urllib2.urlopen(<span class="string">'http://sublime.wbond.net/'</span>+pf.replace(<span class="string">' '</span>,<span class="string">'%20'</span>)).<span class="built_in">read</span>());<span class="built_in">print</span>(<span class="string">'Please restart Sublime Text to finish installation'</span>)</span><br></pre></td></tr></table></figure><blockquote><p>另：手动下载安装，请参考：<a href="http://www.cnblogs.com/tinyphp/p/3217457.html" target="_blank" rel="noopener">http://www.cnblogs.com/tinyphp/p/3217457.html</a> </p></blockquote><p>##二、安装Emmet</p><p>###a、菜单安装</p><p>1、点击菜单Preference–&gt;Package Control<br>2、等待几秒后再弹出如下内容，敲键盘emmet，选择emmet</p><p>###b、命令行安装<br>1、打开命令模式  Ctrl+Shift+p<br>2、输入 install package<br>3、等待几秒后再弹出如下内容，敲键盘emmet，选择emmet</p><blockquote><p>在 Emmet 安装完成后，会显示如下屏幕：然后会自动安装PyV8，安装完成，重启 Sublime Text 3。</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;本文最后更新于：2014-06-4 14:36:03&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/install-emmet-for-sublime-text-3/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;这是Sublime text 3与2版本的安装是有区别的，下面的方法是我感觉比较简单的，其他的要命令什么的感觉太复杂了，经测试是OK的。&lt;/p&gt;
    
    </summary>
    
      <category term="soft" scheme="http://www.yaosansi.com/categories/soft/"/>
    
    
      <category term="sublime text" scheme="http://www.yaosansi.com/tags/sublime-text/"/>
    
      <category term="emmet" scheme="http://www.yaosansi.com/tags/emmet/"/>
    
  </entry>
  
  <entry>
    <title>npm mirror</title>
    <link href="http://www.yaosansi.com/post/npm-mirror/"/>
    <id>http://www.yaosansi.com/post/npm-mirror/</id>
    <published>2014-04-01T05:42:59.000Z</published>
    <updated>2017-12-30T16:01:29.261Z</updated>
    
    <content type="html"><![CDATA[<p><code>本文最后更新于：2014-04-01 13:42:59</code><br><code>原文：http://www.yaosansi.com/post/npm-mirror/</code></p><p>##What is an npm mirror?<br>A mirror is simply a read-only copy of the main npm registry. A mirror lets you install any module that exists in npm. The only thing you can’t do is publish updates or new modules.</p><p>##How do I use an npm mirror?<br>The npm command line tool makes it very easy to use a mirror. There are two ways.</p><p>###Specify the registry when installing:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --registry http://registry.npmjs.org</span><br></pre></td></tr></table></figure><h3 id="Update-the-registry-permanently-in-the-config"><a href="#Update-the-registry-permanently-in-the-config" class="headerlink" title="Update the registry permanently in the config:"></a>Update the registry permanently in the config:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm config <span class="built_in">set</span> registry http://registry.npmjs.org</span><br></pre></td></tr></table></figure><a id="more"></a><hr><h3 id="Main-npm-Registry"><a href="#Main-npm-Registry" class="headerlink" title="Main npm Registry"></a>Main npm Registry</h3><p>Registry: <a href="http://registry.npmjs.org" target="_blank" rel="noopener">http://registry.npmjs.org</a><br>Website: npmjs.org<br>Region: Global<br>Data Center: Joyent, Fastly<br>Maintainer: npm Inc.<br>Established: 2010</p><hr><h3 id="European-npm-Mirror"><a href="#European-npm-Mirror" class="headerlink" title="European npm Mirror"></a>European npm Mirror</h3><p>Registry: <a href="http://registry.npmjs.eu" target="_blank" rel="noopener">http://registry.npmjs.eu</a><br>Website: npmjs.eu<br>Region: Europe, Germany<br>Data Center: Hetzner<br>Maintainer: Maciej Małecki<br>Established: November, 2013</p><hr><h3 id="Australian-npm-Mirror"><a href="#Australian-npm-Mirror" class="headerlink" title="Australian npm Mirror"></a>Australian npm Mirror</h3><p>Registry: <a href="http://registry.npmjs.org.au" target="_blank" rel="noopener">http://registry.npmjs.org.au</a><br>Website: npm.nodejs.org.au<br>Region: Australia<br>Data Center: AWS<br>Maintainer: Rod Vagg<br>Established: July, 2013</p><hr><h3 id="Nodejitsu-US-npm-Mirror"><a href="#Nodejitsu-US-npm-Mirror" class="headerlink" title="Nodejitsu US npm Mirror"></a>Nodejitsu US npm Mirror</h3><p>Registry: <a href="https://registry.nodejitsu.com" target="_blank" rel="noopener">https://registry.nodejitsu.com</a><br>Website: nodejitsu.com<br>Region: US East<br>Data Center: Joyent<br>Maintainer: Nodejitsu<br>Established: January, 2014</p><hr><h3 id="StrongLoop-US-npm-Mirror"><a href="#StrongLoop-US-npm-Mirror" class="headerlink" title="StrongLoop US npm Mirror"></a>StrongLoop US npm Mirror</h3><p>Registry: <a href="https://npm.strongloop.com" target="_blank" rel="noopener">https://npm.strongloop.com</a><br>Website: strongloop.com<br>Region: US West<br>Data Center: Rackspace<br>Maintainer: StrongLoop<br>Established: February, 2014</p><hr><h3 id="China-npm-mirror"><a href="#China-npm-mirror" class="headerlink" title="China npm mirror"></a>China npm mirror</h3><p>Registry: <a href="http://registry.cnpmjs.org" target="_blank" rel="noopener">http://registry.cnpmjs.org</a><br>Website: <a href="http://www.cnpmjs.org/" target="_blank" rel="noopener">http://www.cnpmjs.org/</a><br>Region: China</p><hr>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;本文最后更新于：2014-04-01 13:42:59&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/npm-mirror/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;##What is an npm mirror?&lt;br&gt;A mirror is simply a read-only copy of the main npm registry. A mirror lets you install any module that exists in npm. The only thing you can’t do is publish updates or new modules.&lt;/p&gt;
&lt;p&gt;##How do I use an npm mirror?&lt;br&gt;The npm command line tool makes it very easy to use a mirror. There are two ways.&lt;/p&gt;
&lt;p&gt;###Specify the registry when installing:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ npm install --registry http://registry.npmjs.org&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Update-the-registry-permanently-in-the-config&quot;&gt;&lt;a href=&quot;#Update-the-registry-permanently-in-the-config&quot; class=&quot;headerlink&quot; title=&quot;Update the registry permanently in the config:&quot;&gt;&lt;/a&gt;Update the registry permanently in the config:&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ npm config &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; registry http://registry.npmjs.org&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="nodejs" scheme="http://www.yaosansi.com/categories/nodejs/"/>
    
    
      <category term="nodejs" scheme="http://www.yaosansi.com/tags/nodejs/"/>
    
      <category term="mirror" scheme="http://www.yaosansi.com/tags/mirror/"/>
    
  </entry>
  
  <entry>
    <title>sublime text 3 license(Build 3059 x64)</title>
    <link href="http://www.yaosansi.com/post/sublime-text-3-license/"/>
    <id>http://www.yaosansi.com/post/sublime-text-3-license/</id>
    <published>2014-03-13T08:44:08.000Z</published>
    <updated>2017-12-30T16:02:22.099Z</updated>
    
    <content type="html"><![CDATA[<p><code>原文：http://www.yinqisen.cn/blog-246.html</code></p><p>之前修改check_license 返回值，和其他替换16进制编码的方式都失效了，输入下面的注册码就可以了。<br>申明：只供研究学习，请遵守作者版权。</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">----- BEGIN LICENSE -----</span><br><span class="line">Andrew Weber</span><br><span class="line">Single User License</span><br><span class="line">EA7E-855605</span><br><span class="line">813A03DD 5E4AD9E6 6C0EEB94 BC99798F</span><br><span class="line">942194A6 02396E98 E62C9979 4BB979FE</span><br><span class="line">91424C9D A45400BF F6747D88 2FB88078</span><br><span class="line">90F5CC94 1CDC92DC 8457107A F151657B</span><br><span class="line">1D22E383 A997F016 42397640 33F41CFC</span><br><span class="line">E1D0AE85 A0BBD039 0E9C8D55 E1B89D5D</span><br><span class="line">5CDB7036 E56DE1C0 EFCC0840 650CD3A6</span><br><span class="line">B98FC99C 8FAC73EE D2B95564 DF450523</span><br><span class="line">------ END LICENSE ------</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;原文：http://www.yinqisen.cn/blog-246.html&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;之前修改check_license 返回值，和其他替换16进制编码的方式都失效了，输入下面的注册码就可以了。&lt;br&gt;申明：只供研究学习，请遵守作者版权。&lt;/p&gt;
    
    </summary>
    
      <category term="soft" scheme="http://www.yaosansi.com/categories/soft/"/>
    
    
      <category term="sublime text" scheme="http://www.yaosansi.com/tags/sublime-text/"/>
    
  </entry>
  
  <entry>
    <title>【转载】如何区分H.264视频流的I frame 和 P frame</title>
    <link href="http://www.yaosansi.com/post/how-to-distinguish-between-I-frame-and-P-frame-H264-video-streams/"/>
    <id>http://www.yaosansi.com/post/how-to-distinguish-between-I-frame-and-P-frame-H264-video-streams/</id>
    <published>2013-03-29T05:43:16.000Z</published>
    <updated>2017-12-30T15:58:49.820Z</updated>
    
    <content type="html"><![CDATA[<h2 id="怎么区分H-264视频流的I-frame-和-P-frame？"><a href="#怎么区分H-264视频流的I-frame-和-P-frame？" class="headerlink" title="怎么区分H.264视频流的I frame 和 P frame？"></a>怎么区分H.264视频流的I frame 和 P frame？</h2><p>我是新手，前些天自己看那H.264规范文档及其他资料寻找答案时，<br>还有几个概念的关系还没能理解清楚，望达人指点一二：</p><h3 id="NAL、Slice与frame意思及相互关系"><a href="#NAL、Slice与frame意思及相互关系" class="headerlink" title="NAL、Slice与frame意思及相互关系"></a>NAL、Slice与frame意思及相互关系</h3><h3 id="NAL-nal-unit-type中的1（非IDR图像的编码条带）、2（编码条带数据分割块A）、3（编码条带数据分割块B）、4（编码条带数据分割块C）、5（IDR图像的编码条带）种类型与Slice种的三种编码模式：I-slice、P-slice、B-slice-还有frame的3种类型：I-frame、P-frame、-B-frame之间有什么映射关系么？"><a href="#NAL-nal-unit-type中的1（非IDR图像的编码条带）、2（编码条带数据分割块A）、3（编码条带数据分割块B）、4（编码条带数据分割块C）、5（IDR图像的编码条带）种类型与Slice种的三种编码模式：I-slice、P-slice、B-slice-还有frame的3种类型：I-frame、P-frame、-B-frame之间有什么映射关系么？" class="headerlink" title="NAL nal_unit_type中的1（非IDR图像的编码条带）、2（编码条带数据分割块A）、3（编码条带数据分割块B）、4（编码条带数据分割块C）、5（IDR图像的编码条带）种类型与Slice种的三种编码模式：I_slice、P_slice、B_slice 还有frame的3种类型：I frame、P frame、 B frame之间有什么映射关系么？"></a>NAL nal_unit_type中的1（非IDR图像的编码条带）、2（编码条带数据分割块A）、3（编码条带数据分割块B）、4（编码条带数据分割块C）、5（IDR图像的编码条带）种类型与Slice种的三种编码模式：I_slice、P_slice、B_slice 还有frame的3种类型：I frame、P frame、 B frame之间有什么映射关系么？</h3><h3 id="最后，NAL-nal-unit-type中的6（SEI）、7（SPS）、8（PPS）属于什么帧呢？"><a href="#最后，NAL-nal-unit-type中的6（SEI）、7（SPS）、8（PPS）属于什么帧呢？" class="headerlink" title="最后，NAL nal_unit_type中的6（SEI）、7（SPS）、8（PPS）属于什么帧呢？"></a>最后，NAL nal_unit_type中的6（SEI）、7（SPS）、8（PPS）属于什么帧呢？</h3><a id="more"></a><hr><p>1 frame的数据可以分为多个slice.<br>每个slice中的数据，在帧内预测只用到自己slice的数据， 与其他slice 数据没有依赖关系。<br>NAL 是用来将编码的数据进行大包的。 比如，每一个slice 数据可以放在NAL 包中。<br>I frame 是自己独立编码，不依赖于其他frame 数据。<br>P frame 依赖 I frame 数据。<br>B frame 依赖 I frame, P frame 或其他 B frame 数据。</p><hr><p>那NAL nal_unit_type中的哪几种类型是I frame，现在只能确定nal_unit_type==5（IDR图像的编码条带）是I frame</p><p>sps、pps、SEI算不算I frame呢？ 还有 属于编码条带分割的DPA、DPB、DPC呢？<br>能给个从视频流中提取I frame 和P frame的方法么？</p><hr><p> 一个frame是可以分割成多个Slice来编码的，而一个Slice编码之后被打包进一个NAL单元，不过NAL单元除了容纳Slice编码的码流外，还可以容纳其他数据，比如序列参数集SPS</p><hr><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// H.264 NAL type</span></span><br><span class="line"><span class="keyword">enum</span> H264NALTYPE&#123;</span><br><span class="line">H264NT_NAL = <span class="number">0</span>,</span><br><span class="line">H264NT_SLICE,</span><br><span class="line">H264NT_SLICE_DPA,</span><br><span class="line">H264NT_SLICE_DPB,</span><br><span class="line">H264NT_SLICE_DPC,</span><br><span class="line">H264NT_SLICE_IDR,</span><br><span class="line">H264NT_SEI,</span><br><span class="line">H264NT_SPS,</span><br><span class="line">H264NT_PPS,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">H264GetNALType</span><span class="params">(LPVOID pBSBuf, <span class="keyword">const</span> LONG nBSLen)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> ( nBSLen &lt; <span class="number">5</span> ) <span class="comment">// 不完整的NAL单元</span></span><br><span class="line"><span class="keyword">return</span> H264NT_NAL;</span><br><span class="line"></span><br><span class="line">UINT8* pBS = (UINT8 *)pBSBuf;</span><br><span class="line">ULONG nType = pBS[<span class="number">4</span>] &amp; <span class="number">0x1F</span>; <span class="comment">// NAL类型在固定的位置上 :)</span></span><br><span class="line"><span class="keyword">if</span> ( nType &lt;= H264NT_PPS )</span><br><span class="line"><span class="keyword">return</span> nType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中 H264NT_SLICE_IDR 是关键帧，H264NT_SLICE 是P帧</p><hr><p>一个frame是可以分割成多个Slice来编码的，而一个Slice编码之后被打包进一个NAL单元，不过NAL单元除了容纳Slice编码的码流外，还可以容纳其他数据，比如序列参数集SPS。</p><hr><ul><li>1、NAL、Slice与frame意思及相互关系  </li></ul><blockquote><p>NAL指网络提取层，里面放一些与网络相关的信息<br>Slice是片的意思，264中把图像分成一帧（frame）或两场（field），而帧又可以分成一个或几个片（Slilce）；片由宏块（MB）组成。宏块是编码处理的基本单元。</p></blockquote><ul><li>2、NAL nal_unit_type中的1（非IDR图像的编码条带）、2（编码条带数据分割块A）、3（编码条带数据分割块B）、4（编码条带数据分割块C）、5（IDR图像的编码条带）种类型<br>与 Slice种的三种编码模式：I_slice、P_slice、B_slice<br>NAL nal_unit_type 里的五种类型</li></ul><blockquote><p>代表接下来数据是表示啥信息的和具体如何分块。<br>I_slice、P_slice、B_slice 表示I类型的片、P类型的片，B类型的片.其中I_slice为帧内预测模式编码；P_slice为单向预测编码或帧内模式；B_slice 中为双向预测或帧内模式。</p></blockquote><ul><li>3、还有frame的3种类型：I frame、P frame、 B frame之间有什么映射关系么？  </li></ul><blockquote><p>I frame、P frame、 B frame关系同 I_slice、P_slice、B_slice，slice和frame区别在问题1中已经讲明白。</p></blockquote><ul><li>4、最后，NAL nal_unit_type中的6（SEI）、7（SPS）、8（PPS）属于什么帧呢？  </li></ul><blockquote><p>NAL nal_unit_type 为序列参数集（SPS）、图像参数集（PPS）、增强信息（SEI）不属于啥帧的概念。表示后面的数据信息为序列参数集（SPS）、图像参数集（PPS）、增强信息（SEI）。</p></blockquote><p>h.264解码中首先过滤码流获得参数集，参数集是H.264标准的一个新概念，是一种通过改进视频码流结构增强错误恢复能力的方法。</p><p>众所周知，一 些关键信息比特的丢失（如序列和图像的头信息）会造成解码的严重负面效应，而H.264把这些关键信息分离出来，凭借参数集的设计，确保在易出错的环境中 能正确地传输。这种码流结构的设计无疑增强了码流传输的错误恢复能力。 </p><p>H.264的参数集又分为序列参数集（Sequence parameter set）和图像参数集（Picture parameter set）。其中，序列参数集包括一个图像序列的所有信息，即两个IDR图像间的所有图像信息。图像参数集包括一个图像的所有分片的所有相关信息，包括图像 类型、序列号等，解码时某些序列号的丢失可用来检验信息包的丢失与否。多个不同的序列和图像参数集存储在解码器中，编码器依据每个编码分片的头部的存储位置来选择适当的参数集，图像参数集本身也包括使用的序列参数集参考信息。  </p><p>参数集具体实现的方法也是多样化的：<br>（1）通过带外传输，这种方式要求参数集通过可靠的协议，在首个片编码到达之前传输到解码器；<br>（2）通过带内传 输，这需要为参数集提供更高级别的保护，例如发送复制包来保证至少有一个到达目标；<br>（3）在编码器和解码器采用硬件处理参数集。 </p><p>序列参数集以及图像参数集要在解码前传输，在解码的过程中被激活。一旦被激活，则上一个序列参数集或者图象参数集就失效了。图象参数集是被使用它的 slice data或者使用它的A分割的Nalu激活的。而序列参数集是被使用它的图象参数集或者包括缓冲期消息的SEI nalu所激活。</p><p>同一个IDR图象的序列参数集有相同的seq_parameter_set_id，直到一个图象的最后一个access unit或者包括缓冲期消息的SEI Nalu，这时需要出现下一个图象的序列参数集。<br>下一个图象的序列参数集被SEI nalu激活。如果序列参数集和图象参数集是通过其他传输管道发送的，则要保证以上的传输顺序。</p><hr><p>H.264视频流是以NAL单元传送的。。。但在一个NAL单元里面，可能既存放I-Slice（P-Slice或B-Slice），同时也可能存放图像的其他信息<br>那么 是不是说 I frame， P frame，B frame是把收到的NAL单元中的VCL的信息先提取出，然后按内容进行I、P、B frame分类？ </p><p>而我们只能通过NAL nal_unit_type来判别NAL单元中数据的类型哈~~~ </p><hr><p>呵呵 不好意思 还没有完全理解~~ </p><hr><p>NAL单元中首先会有一个H.264 NAL type，根据这个可以判断是啥信息。如果是<br>H264NT_SLICE_DPA,H264NT_SLICE_DPB,H264NT_SLICE_DPC, H264NT_SLICE_IDR视频数据相关的，里面还会有Slice head头信息，根据这个头信息，可以判断属于I-Slice（P-Slice或B-Slice），之后对于每个宏块，都会有MB head 信息，根据宏块头信息可以判断块模式。</p><p>H264就是这样以分层的方式组织信息的。不知道你理解没有。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;怎么区分H-264视频流的I-frame-和-P-frame？&quot;&gt;&lt;a href=&quot;#怎么区分H-264视频流的I-frame-和-P-frame？&quot; class=&quot;headerlink&quot; title=&quot;怎么区分H.264视频流的I frame 和 P frame？&quot;&gt;&lt;/a&gt;怎么区分H.264视频流的I frame 和 P frame？&lt;/h2&gt;&lt;p&gt;我是新手，前些天自己看那H.264规范文档及其他资料寻找答案时，&lt;br&gt;还有几个概念的关系还没能理解清楚，望达人指点一二：&lt;/p&gt;
&lt;h3 id=&quot;NAL、Slice与frame意思及相互关系&quot;&gt;&lt;a href=&quot;#NAL、Slice与frame意思及相互关系&quot; class=&quot;headerlink&quot; title=&quot;NAL、Slice与frame意思及相互关系&quot;&gt;&lt;/a&gt;NAL、Slice与frame意思及相互关系&lt;/h3&gt;&lt;h3 id=&quot;NAL-nal-unit-type中的1（非IDR图像的编码条带）、2（编码条带数据分割块A）、3（编码条带数据分割块B）、4（编码条带数据分割块C）、5（IDR图像的编码条带）种类型与Slice种的三种编码模式：I-slice、P-slice、B-slice-还有frame的3种类型：I-frame、P-frame、-B-frame之间有什么映射关系么？&quot;&gt;&lt;a href=&quot;#NAL-nal-unit-type中的1（非IDR图像的编码条带）、2（编码条带数据分割块A）、3（编码条带数据分割块B）、4（编码条带数据分割块C）、5（IDR图像的编码条带）种类型与Slice种的三种编码模式：I-slice、P-slice、B-slice-还有frame的3种类型：I-frame、P-frame、-B-frame之间有什么映射关系么？&quot; class=&quot;headerlink&quot; title=&quot;NAL nal_unit_type中的1（非IDR图像的编码条带）、2（编码条带数据分割块A）、3（编码条带数据分割块B）、4（编码条带数据分割块C）、5（IDR图像的编码条带）种类型与Slice种的三种编码模式：I_slice、P_slice、B_slice 还有frame的3种类型：I frame、P frame、 B frame之间有什么映射关系么？&quot;&gt;&lt;/a&gt;NAL nal_unit_type中的1（非IDR图像的编码条带）、2（编码条带数据分割块A）、3（编码条带数据分割块B）、4（编码条带数据分割块C）、5（IDR图像的编码条带）种类型与Slice种的三种编码模式：I_slice、P_slice、B_slice 还有frame的3种类型：I frame、P frame、 B frame之间有什么映射关系么？&lt;/h3&gt;&lt;h3 id=&quot;最后，NAL-nal-unit-type中的6（SEI）、7（SPS）、8（PPS）属于什么帧呢？&quot;&gt;&lt;a href=&quot;#最后，NAL-nal-unit-type中的6（SEI）、7（SPS）、8（PPS）属于什么帧呢？&quot; class=&quot;headerlink&quot; title=&quot;最后，NAL nal_unit_type中的6（SEI）、7（SPS）、8（PPS）属于什么帧呢？&quot;&gt;&lt;/a&gt;最后，NAL nal_unit_type中的6（SEI）、7（SPS）、8（PPS）属于什么帧呢？&lt;/h3&gt;
    
    </summary>
    
      <category term="video" scheme="http://www.yaosansi.com/categories/video/"/>
    
    
      <category term="video" scheme="http://www.yaosansi.com/tags/video/"/>
    
      <category term="h.264" scheme="http://www.yaosansi.com/tags/h-264/"/>
    
      <category term="frame" scheme="http://www.yaosansi.com/tags/frame/"/>
    
  </entry>
  
  <entry>
    <title>H.264视频文件转换成TS</title>
    <link href="http://www.yaosansi.com/post/h264-video-mp4-to-ts/"/>
    <id>http://www.yaosansi.com/post/h264-video-mp4-to-ts/</id>
    <published>2012-09-04T15:38:51.000Z</published>
    <updated>2017-12-30T16:05:31.007Z</updated>
    
    <content type="html"><![CDATA[<p><code>本文最后更新于：2012-09-04 23:38:51</code><br><code>原文：http://www.yaosansi.com/post/h264-video-mp4-to-ts</code></p><h2 id="Mp4-To-TS"><a href="#Mp4-To-TS" class="headerlink" title="Mp4 To TS"></a>Mp4 To TS</h2><ul><li>使用ffmpeg </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i &quot;test.mp4&quot; -i &quot;test.aac&quot; -f mpegts  -vcodec copy -acodec copy -vbsf h264_mp4toannexb -y test.ts</span><br></pre></td></tr></table></figure><p>如果不使用-vbsf h264_mp4toannexb ，将出现如下提示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[mpegts @ 0x61c040] h264 bitstream malformated, no startcode found, use -vbsf h264_mp4toannexb av_interleaved_write_frame(): Operation not permitted</span><br></pre></td></tr></table></figure><ul><li>使用vlc</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vlc  -vvv --extraintf=logger  test.mp4 :sout=#std&#123;access=file,mux=ts,dst=test.ts&#125;</span><br></pre></td></tr></table></figure><h2 id="合并MP4"><a href="#合并MP4" class="headerlink" title="合并MP4"></a>合并MP4</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i 1.mp4 -sameq 1.mpg ffmpeg -i 2.mp4 -sameq 2.mpg cat 1.mpg 2.mpg | ffmpeg -f mpeg -i - -sameq -vcodec mpeg4 output.mp4</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i concat:&quot;video1.mp4|video2.mp4&quot;</span><br></pre></td></tr></table></figure><p>###当然也可以使用 mp4box 分割或合并MP4</p><ul><li>分割：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MP4Box -split time_sec foo.mp4 #按照时长切割MP4文件</span><br><span class="line">MP4Box -split-size size foo.mp4 #按照文件大小切割MP4文件，单位是KB</span><br><span class="line">MP4Box -split-chunk S:E foo.mp4 #切出视频中指定时间的一段</span><br></pre></td></tr></table></figure><ul><li>合并：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#这样就合并了，要求编码参数一致</span><br><span class="line">MP4Box -cat foo1.mp4 -cat foo2.mp4 -new foo.mp4 </span><br><span class="line">MP4Box -force-cat foo1.mp4 -force-cat foo2.mp4 -new foo.mp4 #强制合并，有可能合出来看不了</span><br><span class="line">MP4Box -add video1.264 -cat video2.264 -cat video3.264 -add audio1.aac -cat audio2.aac -cat audio3.aac -new muxed.mp4 -fps 24</span><br></pre></td></tr></table></figure><ul><li>加版权信息：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MP4Box -cprt sinav foo.mp4</span><br></pre></td></tr></table></figure><h3 id="TS-To-Mp4"><a href="#TS-To-Mp4" class="headerlink" title="TS To  Mp4"></a>TS To  Mp4</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i input.ts -c:v copy -c:a libfaac out.mp4</span><br><span class="line">ffmpeg -i input.ts -c:v libx264 -crf 24 -c:a libfaac out.mp4</span><br><span class="line">Set CRF to anything between 19 and 25, or even more. The more, the worse the quality, but the smaller the file size.</span><br></pre></td></tr></table></figure><p>部分引用：<a href="http://blog.yikuyiku.com/?p=1854" target="_blank" rel="noopener">http://blog.yikuyiku.com/?p=1854</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;code&gt;本文最后更新于：2012-09-04 23:38:51&lt;/code&gt;&lt;br&gt;&lt;code&gt;原文：http://www.yaosansi.com/post/h264-video-mp4-to-ts&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;Mp4-To-TS&quot;&gt;&lt;a h
      
    
    </summary>
    
      <category term="video" scheme="http://www.yaosansi.com/categories/video/"/>
    
    
      <category term="ffmpeg" scheme="http://www.yaosansi.com/tags/ffmpeg/"/>
    
  </entry>
  
</feed>
